<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>scran: scran::RunPCA Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">scran
   </div>
   <div id="projectbrief">C++ library for basic single-cell RNA-seq analyses</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescran.html">scran</a></li><li class="navelem"><a class="el" href="classscran_1_1RunPCA.html">RunPCA</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classscran_1_1RunPCA-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">scran::RunPCA Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Perform PCA on a gene-cell matrix.  
 <a href="classscran_1_1RunPCA.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="RunPCA_8hpp_source.html">RunPCA.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran_1_1RunPCA_1_1Defaults.html">Defaults</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default parameter settings.  <a href="structscran_1_1RunPCA_1_1Defaults.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran_1_1RunPCA_1_1Results.html">Results</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Container for the PCA results.  <a href="structscran_1_1RunPCA_1_1Results.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a736079c03235fca4ec6bfd7b99b0f565"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classscran_1_1RunPCA.html">RunPCA</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran_1_1RunPCA.html#a736079c03235fca4ec6bfd7b99b0f565">set_rank</a> (int r=<a class="el" href="structscran_1_1RunPCA_1_1Defaults.html#aef3a3b0bc2ac4b8f703389030c10de25">Defaults::rank</a>)</td></tr>
<tr class="separator:a736079c03235fca4ec6bfd7b99b0f565"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d39126e34713d4cb843d24b8969708b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classscran_1_1RunPCA.html">RunPCA</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran_1_1RunPCA.html#a6d39126e34713d4cb843d24b8969708b">set_scale</a> (bool s=<a class="el" href="structscran_1_1RunPCA_1_1Defaults.html#a4c119fb26b242f1c70eeb51d94de81ab">Defaults::scale</a>)</td></tr>
<tr class="separator:a6d39126e34713d4cb843d24b8969708b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cb07ef5a77b9255320ec477c70d4f4c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classscran_1_1RunPCA.html">RunPCA</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran_1_1RunPCA.html#a6cb07ef5a77b9255320ec477c70d4f4c">set_transpose</a> (bool t=<a class="el" href="structscran_1_1RunPCA_1_1Defaults.html#a67085e4eaa6e0010aea2962ce37c5ac0">Defaults::transpose</a>)</td></tr>
<tr class="separator:a6cb07ef5a77b9255320ec477c70d4f4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addc4e65cd4d609bd10de4e672800e695"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classscran_1_1RunPCA.html">RunPCA</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran_1_1RunPCA.html#addc4e65cd4d609bd10de4e672800e695">set_num_threads</a> (int n=<a class="el" href="structscran_1_1RunPCA_1_1Defaults.html#a6a7c18f8cebd4812d0d6980c16b0f778">Defaults::num_threads</a>)</td></tr>
<tr class="separator:addc4e65cd4d609bd10de4e672800e695"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9ae75c4e5d6ed4feef25faadea32a93"><td class="memTemplParams" colspan="2">template&lt;typename T , typename IDX &gt; </td></tr>
<tr class="memitem:ad9ae75c4e5d6ed4feef25faadea32a93"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="structscran_1_1RunPCA_1_1Results.html">Results</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classscran_1_1RunPCA.html#ad9ae75c4e5d6ed4feef25faadea32a93">run</a> (const tatami::Matrix&lt; T, IDX &gt; *mat) const</td></tr>
<tr class="separator:ad9ae75c4e5d6ed4feef25faadea32a93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88c07d13b1c5b726696352a067b4eced"><td class="memTemplParams" colspan="2">template&lt;typename T , typename IDX , typename X &gt; </td></tr>
<tr class="memitem:a88c07d13b1c5b726696352a067b4eced"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="structscran_1_1RunPCA_1_1Results.html">Results</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classscran_1_1RunPCA.html#a88c07d13b1c5b726696352a067b4eced">run</a> (const tatami::Matrix&lt; T, IDX &gt; *mat, const X *features) const</td></tr>
<tr class="separator:a88c07d13b1c5b726696352a067b4eced"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Perform PCA on a gene-cell matrix. </p>
<p>Principal components analysis (PCA) is a helpful technique for data compression and denoising. The idea is that the earlier PCs capture most of the systematic biological variation while the later PCs capture random technical noise. Thus, we can reduce the size of the data and eliminate noise by only using the earlier PCs for further analyses. Most practitioners will keep the first 10-50 PCs, though the exact choice is fairly arbitrary. For speed, we use the <a href="https://github.com/LTLA/CppIrlba"><b>CppIrlba</b></a> package to perform an approximate PCA. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a736079c03235fca4ec6bfd7b99b0f565" name="a736079c03235fca4ec6bfd7b99b0f565"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a736079c03235fca4ec6bfd7b99b0f565">&#9670;&#160;</a></span>set_rank()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran_1_1RunPCA.html">RunPCA</a> &amp; scran::RunPCA::set_rank </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>r</em> = <code><a class="el" href="structscran_1_1RunPCA_1_1Defaults.html#aef3a3b0bc2ac4b8f703389030c10de25">Defaults::rank</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">r</td><td>Number of PCs to compute. This should be smaller than the smaller dimension of the input matrix.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A reference to this <code><a class="el" href="classscran_1_1RunPCA.html" title="Perform PCA on a gene-cell matrix.">RunPCA</a></code> instance. </dd></dl>

</div>
</div>
<a id="a6d39126e34713d4cb843d24b8969708b" name="a6d39126e34713d4cb843d24b8969708b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d39126e34713d4cb843d24b8969708b">&#9670;&#160;</a></span>set_scale()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran_1_1RunPCA.html">RunPCA</a> &amp; scran::RunPCA::set_scale </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>s</em> = <code><a class="el" href="structscran_1_1RunPCA_1_1Defaults.html#a4c119fb26b242f1c70eeb51d94de81ab">Defaults::scale</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>Should genes be scaled to unit variance?</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A reference to this <code><a class="el" href="classscran_1_1RunPCA.html" title="Perform PCA on a gene-cell matrix.">RunPCA</a></code> instance. </dd></dl>

</div>
</div>
<a id="a6cb07ef5a77b9255320ec477c70d4f4c" name="a6cb07ef5a77b9255320ec477c70d4f4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cb07ef5a77b9255320ec477c70d4f4c">&#9670;&#160;</a></span>set_transpose()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran_1_1RunPCA.html">RunPCA</a> &amp; scran::RunPCA::set_transpose </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>t</em> = <code><a class="el" href="structscran_1_1RunPCA_1_1Defaults.html#a67085e4eaa6e0010aea2962ce37c5ac0">Defaults::transpose</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t</td><td>Should the PC matrix be transposed on output? If <code>true</code>, the output matrix is column-major with cells in the columns, which is compatible with downstream <b>libscran</b> steps.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A reference to this <code><a class="el" href="classscran_1_1RunPCA.html" title="Perform PCA on a gene-cell matrix.">RunPCA</a></code> instance. </dd></dl>

</div>
</div>
<a id="addc4e65cd4d609bd10de4e672800e695" name="addc4e65cd4d609bd10de4e672800e695"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addc4e65cd4d609bd10de4e672800e695">&#9670;&#160;</a></span>set_num_threads()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran_1_1RunPCA.html">RunPCA</a> &amp; scran::RunPCA::set_num_threads </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em> = <code><a class="el" href="structscran_1_1RunPCA_1_1Defaults.html#a6a7c18f8cebd4812d0d6980c16b0f778">Defaults::num_threads</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>Number of threads to use. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A reference to this <code><a class="el" href="classscran_1_1RunPCA.html" title="Perform PCA on a gene-cell matrix.">RunPCA</a></code> instance. </dd></dl>

</div>
</div>
<a id="ad9ae75c4e5d6ed4feef25faadea32a93" name="ad9ae75c4e5d6ed4feef25faadea32a93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9ae75c4e5d6ed4feef25faadea32a93">&#9670;&#160;</a></span>run() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename IDX &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structscran_1_1RunPCA_1_1Results.html">Results</a> scran::RunPCA::run </td>
          <td>(</td>
          <td class="paramtype">const tatami::Matrix&lt; T, IDX &gt; *&#160;</td>
          <td class="paramname"><em>mat</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Run PCA on an input gene-by-cell matrix.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T</td><td>Floating point type for the data. </td></tr>
    <tr><td class="paramname">IDX</td><td>Integer type for the indices.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mat</td><td>Pointer to the input matrix. Columns should contain cells while rows should contain genes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <code><a class="el" href="structscran_1_1RunPCA_1_1Results.html" title="Container for the PCA results.">Results</a></code> object containing the PCs and the variance explained. </dd></dl>

</div>
</div>
<a id="a88c07d13b1c5b726696352a067b4eced" name="a88c07d13b1c5b726696352a067b4eced"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88c07d13b1c5b726696352a067b4eced">&#9670;&#160;</a></span>run() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename IDX , typename X &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structscran_1_1RunPCA_1_1Results.html">Results</a> scran::RunPCA::run </td>
          <td>(</td>
          <td class="paramtype">const tatami::Matrix&lt; T, IDX &gt; *&#160;</td>
          <td class="paramname"><em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const X *&#160;</td>
          <td class="paramname"><em>features</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Run PCA on an input gene-by-cell matrix after filtering for genes of interest. We typically use the set of highly variable genes from <code><a class="el" href="classscran_1_1ChooseHVGs.html" title="Choose highly variable genes for downstream analyses.">ChooseHVGs</a></code>, with the aim being to improve computational efficiency and avoid random noise by removing lowly variable genes.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T</td><td>Floating point type for the data. </td></tr>
    <tr><td class="paramname">IDX</td><td>Integer type for the indices. </td></tr>
    <tr><td class="paramname">X</td><td>Integer type for the feature filter.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mat</td><td>Pointer to the input matrix. Columns should contain cells while rows should contain genes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">features</td><td>Pointer to an array of length equal to the number of genes. Each entry treated as a boolean specifying whether the corresponding genes should be used in the PCA.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <code><a class="el" href="structscran_1_1RunPCA_1_1Results.html" title="Container for the PCA results.">Results</a></code> object containing the PCs and the variance explained. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>scran/dimensionality_reduction/<a class="el" href="RunPCA_8hpp_source.html">RunPCA.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7
</small></address>
</body>
</html>
