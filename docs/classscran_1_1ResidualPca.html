<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>scran: scran::ResidualPca Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">scran
   </div>
   <div id="projectbrief">C++ library for basic single-cell RNA-seq analyses</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescran.html">scran</a></li><li class="navelem"><a class="el" href="classscran_1_1ResidualPca.html">ResidualPca</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classscran_1_1ResidualPca-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">scran::ResidualPca Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Compute PCA after regressing out an uninteresting factor.  
 <a href="classscran_1_1ResidualPca.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="ResidualPca_8hpp_source.html">ResidualPca.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran_1_1ResidualPca_1_1Defaults.html">Defaults</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default parameter settings.  <a href="structscran_1_1ResidualPca_1_1Defaults.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran_1_1ResidualPca_1_1Results.html">Results</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Container for the PCA results.  <a href="structscran_1_1ResidualPca_1_1Results.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-types" name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:aa6ff98f2ed51c84448fead6dc615ccb4"><td class="memItemLeft" align="right" valign="top">enum class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran_1_1ResidualPca.html#aa6ff98f2ed51c84448fead6dc615ccb4">WeightPolicy</a> : char { <b>NONE</b>
, <b>EQUAL</b>
 }</td></tr>
<tr class="separator:aa6ff98f2ed51c84448fead6dc615ccb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ae1ff4875ca2f108d254c424c005575a8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classscran_1_1ResidualPca.html">ResidualPca</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran_1_1ResidualPca.html#ae1ff4875ca2f108d254c424c005575a8">set_rank</a> (int r=<a class="el" href="structscran_1_1ResidualPca_1_1Defaults.html#a1f4a079dc99da1ac459eb7ec099669d1">Defaults::rank</a>)</td></tr>
<tr class="separator:ae1ff4875ca2f108d254c424c005575a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2b312fd38febe013970a4d926fc7222"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classscran_1_1ResidualPca.html">ResidualPca</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran_1_1ResidualPca.html#ab2b312fd38febe013970a4d926fc7222">set_scale</a> (bool s=<a class="el" href="structscran_1_1ResidualPca_1_1Defaults.html#a7004b802a6b2bb54c3b87eb904853fc9">Defaults::scale</a>)</td></tr>
<tr class="separator:ab2b312fd38febe013970a4d926fc7222"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a1e82d10dcacbae854213f4dea206c0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classscran_1_1ResidualPca.html">ResidualPca</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran_1_1ResidualPca.html#a5a1e82d10dcacbae854213f4dea206c0">set_transpose</a> (bool t=<a class="el" href="structscran_1_1ResidualPca_1_1Defaults.html#a3836f907b9af2445b61cb38dba7a2d3a">Defaults::transpose</a>)</td></tr>
<tr class="separator:a5a1e82d10dcacbae854213f4dea206c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a935c56294aa05af7aa6157f4569b8023"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classscran_1_1ResidualPca.html">ResidualPca</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran_1_1ResidualPca.html#a935c56294aa05af7aa6157f4569b8023">set_weight_policy</a> (<a class="el" href="classscran_1_1ResidualPca.html#aa6ff98f2ed51c84448fead6dc615ccb4">WeightPolicy</a> w=<a class="el" href="structscran_1_1ResidualPca_1_1Defaults.html#ad313b5573f8175ab1fb474481126bf41">Defaults::weight_policy</a>)</td></tr>
<tr class="separator:a935c56294aa05af7aa6157f4569b8023"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2c684105303d49ac35a261509ef379e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classscran_1_1ResidualPca.html">ResidualPca</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran_1_1ResidualPca.html#aa2c684105303d49ac35a261509ef379e">set_weight_size_cap</a> (int w=<a class="el" href="structscran_1_1ResidualPca_1_1Defaults.html#aec288e788534dfae8158ae5d7bfe09a0">Defaults::weight_size_cap</a>)</td></tr>
<tr class="separator:aa2c684105303d49ac35a261509ef379e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a352355b0cdd190b5829239ac9c80dd94"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classscran_1_1ResidualPca.html">ResidualPca</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran_1_1ResidualPca.html#a352355b0cdd190b5829239ac9c80dd94">set_return_rotation</a> (bool r=<a class="el" href="structscran_1_1ResidualPca_1_1Defaults.html#a28c4016fe15012de3bf8b73e5b53bc9b">Defaults::return_rotation</a>)</td></tr>
<tr class="separator:a352355b0cdd190b5829239ac9c80dd94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9ce7a7e950c2d77c6dea583f2e8c05c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classscran_1_1ResidualPca.html">ResidualPca</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran_1_1ResidualPca.html#af9ce7a7e950c2d77c6dea583f2e8c05c">set_return_center</a> (bool r=<a class="el" href="structscran_1_1ResidualPca_1_1Defaults.html#aa6ddf96e0cd7f882e14056a82c25c1bf">Defaults::return_center</a>)</td></tr>
<tr class="separator:af9ce7a7e950c2d77c6dea583f2e8c05c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6165921f6bff7b76132c7b731b6f743a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classscran_1_1ResidualPca.html">ResidualPca</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran_1_1ResidualPca.html#a6165921f6bff7b76132c7b731b6f743a">set_return_scale</a> (bool r=<a class="el" href="structscran_1_1ResidualPca_1_1Defaults.html#a3c10dbaa4c5cb0aa54a7ac4f0c70c186">Defaults::return_scale</a>)</td></tr>
<tr class="separator:a6165921f6bff7b76132c7b731b6f743a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac000899a60ede0cbaa32c6704d05f80a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classscran_1_1ResidualPca.html">ResidualPca</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran_1_1ResidualPca.html#ac000899a60ede0cbaa32c6704d05f80a">set_num_threads</a> (int n=<a class="el" href="structscran_1_1ResidualPca_1_1Defaults.html#aa39b75d211b4278a58ff86879a2d1e78">Defaults::num_threads</a>)</td></tr>
<tr class="separator:ac000899a60ede0cbaa32c6704d05f80a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58b14f9c25cdc6aa1e0c075a2b37f9c1"><td class="memTemplParams" colspan="2">template&lt;typename Data_ , typename Index_ , typename Block_ &gt; </td></tr>
<tr class="memitem:a58b14f9c25cdc6aa1e0c075a2b37f9c1"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="structscran_1_1ResidualPca_1_1Results.html">Results</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classscran_1_1ResidualPca.html#a58b14f9c25cdc6aa1e0c075a2b37f9c1">run</a> (const tatami::Matrix&lt; Data_, Index_ &gt; *mat, const Block_ *block) const</td></tr>
<tr class="separator:a58b14f9c25cdc6aa1e0c075a2b37f9c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e18e6391f88d2b52f612e10a77a1fee"><td class="memTemplParams" colspan="2">template&lt;typename Data_ , typename Index_ , typename Block_ , typename Subset_ &gt; </td></tr>
<tr class="memitem:a9e18e6391f88d2b52f612e10a77a1fee"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="structscran_1_1ResidualPca_1_1Results.html">Results</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classscran_1_1ResidualPca.html#a9e18e6391f88d2b52f612e10a77a1fee">run</a> (const tatami::Matrix&lt; Data_, Index_ &gt; *mat, const Block_ *block, const Subset_ *features) const</td></tr>
<tr class="separator:a9e18e6391f88d2b52f612e10a77a1fee"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Compute PCA after regressing out an uninteresting factor. </p>
<p>A simple batch correction method involves centering the expression of each gene in each batch to remove systematic differences between batches. The residuals are then used in PCA to obtain a batch-corrected low-dimensional representation of the dataset. Unfortunately, naively centering the expression values will discard sparsity and reduce the computational efficiency of the PCA. To avoid these drawbacks, <code><a class="el" href="classscran_1_1ResidualPca.html" title="Compute PCA after regressing out an uninteresting factor.">ResidualPca</a></code> defers the residual calculation until the matrix multiplication of the IRLBA step. This yields the same results as the naive approach but is much faster as it can take advantage of efficient sparse operations.</p>
<p>We can optionally scale each batch so that they contribute equally to the rotation vectors, regardless of their size. This is achieved using the same approach described in <code><a class="el" href="classscran_1_1MultiBatchPca.html" title="Compute PCA after adjusting for differences between batch sizes.">MultiBatchPca</a></code>, whereby batches with more cells are downscaled during calculation of the rotation vectors. The final PCs are then obtained by projecting the residuals onto the space defined by the rotation vectors. This ensures that larger batches do not mask interesting variation in other batches.</p>
<p>Note that the use of residuals for batch correction makes some strong assumptions about the batches, e.g., they have the same composition and the batch effect is a consistent shift for all populations. Non-linear correction algorithms are usually more effective, e.g., <a href="https://github.com/LTLA/CppMnnCorrect">MNN correction</a>. </p>
</div><h2 class="groupheader">Member Enumeration Documentation</h2>
<a id="aa6ff98f2ed51c84448fead6dc615ccb4" name="aa6ff98f2ed51c84448fead6dc615ccb4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6ff98f2ed51c84448fead6dc615ccb4">&#9670;&#160;</a></span>WeightPolicy</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum class <a class="el" href="classscran_1_1ResidualPca.html#aa6ff98f2ed51c84448fead6dc615ccb4">scran::ResidualPca::WeightPolicy</a> : char</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">strong</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Policy to use for weighting batches based on their size, i.e., the number of cells in each batch.</p>
<ul>
<li><code>NONE</code>: no weighting is performed. This means that larger batches will contribute more to the calculation of the rotation vectors in the PCA.</li>
<li><code>EQUAL</code>: each batch is downscaled in proportion to its number of cells, such that all batches contribute "equally" to the rotation vectors regardless of their size. </li>
</ul>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ae1ff4875ca2f108d254c424c005575a8" name="ae1ff4875ca2f108d254c424c005575a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1ff4875ca2f108d254c424c005575a8">&#9670;&#160;</a></span>set_rank()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran_1_1ResidualPca.html">ResidualPca</a> &amp; scran::ResidualPca::set_rank </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>r</em> = <code><a class="el" href="structscran_1_1ResidualPca_1_1Defaults.html#a1f4a079dc99da1ac459eb7ec099669d1">Defaults::rank</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">r</td><td>Number of PCs to compute. This should be smaller than the smaller dimension of the input matrix.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A reference to this <code><a class="el" href="classscran_1_1ResidualPca.html" title="Compute PCA after regressing out an uninteresting factor.">ResidualPca</a></code> instance. </dd></dl>

</div>
</div>
<a id="ab2b312fd38febe013970a4d926fc7222" name="ab2b312fd38febe013970a4d926fc7222"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2b312fd38febe013970a4d926fc7222">&#9670;&#160;</a></span>set_scale()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran_1_1ResidualPca.html">ResidualPca</a> &amp; scran::ResidualPca::set_scale </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>s</em> = <code><a class="el" href="structscran_1_1ResidualPca_1_1Defaults.html#a7004b802a6b2bb54c3b87eb904853fc9">Defaults::scale</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>Should genes be scaled to unit variance?</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A reference to this <code><a class="el" href="classscran_1_1ResidualPca.html" title="Compute PCA after regressing out an uninteresting factor.">ResidualPca</a></code> instance. </dd></dl>

</div>
</div>
<a id="a5a1e82d10dcacbae854213f4dea206c0" name="a5a1e82d10dcacbae854213f4dea206c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a1e82d10dcacbae854213f4dea206c0">&#9670;&#160;</a></span>set_transpose()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran_1_1ResidualPca.html">ResidualPca</a> &amp; scran::ResidualPca::set_transpose </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>t</em> = <code><a class="el" href="structscran_1_1ResidualPca_1_1Defaults.html#a3836f907b9af2445b61cb38dba7a2d3a">Defaults::transpose</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t</td><td>Should the PC matrix be transposed on output? If <code>true</code>, the output PC matrix is column-major with cells in the columns, which is compatible with downstream <b>libscran</b> steps.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A reference to this <code><a class="el" href="classscran_1_1ResidualPca.html" title="Compute PCA after regressing out an uninteresting factor.">ResidualPca</a></code> instance. </dd></dl>

</div>
</div>
<a id="a935c56294aa05af7aa6157f4569b8023" name="a935c56294aa05af7aa6157f4569b8023"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a935c56294aa05af7aa6157f4569b8023">&#9670;&#160;</a></span>set_weight_policy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran_1_1ResidualPca.html">ResidualPca</a> &amp; scran::ResidualPca::set_weight_policy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran_1_1ResidualPca.html#aa6ff98f2ed51c84448fead6dc615ccb4">WeightPolicy</a>&#160;</td>
          <td class="paramname"><em>w</em> = <code><a class="el" href="structscran_1_1ResidualPca_1_1Defaults.html#ad313b5573f8175ab1fb474481126bf41">Defaults::weight_policy</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">w</td><td>Policy to use for weighting batches of different size, see <code>WeightPolicy</code> for details.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A reference to this <code><a class="el" href="classscran_1_1ResidualPca.html" title="Compute PCA after regressing out an uninteresting factor.">ResidualPca</a></code> instance. </dd></dl>

</div>
</div>
<a id="aa2c684105303d49ac35a261509ef379e" name="aa2c684105303d49ac35a261509ef379e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2c684105303d49ac35a261509ef379e">&#9670;&#160;</a></span>set_weight_size_cap()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran_1_1ResidualPca.html">ResidualPca</a> &amp; scran::ResidualPca::set_weight_size_cap </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>w</em> = <code><a class="el" href="structscran_1_1ResidualPca_1_1Defaults.html#aec288e788534dfae8158ae5d7bfe09a0">Defaults::weight_size_cap</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">w</td><td>Cap on the size of each block (i.e., number of cells), above which all blocks are to be assigned equal weight - see <code><a class="el" href="namespacescran.html#a9bf9566ed0cbf9bf3cb310f0847ca5cd">weight_block()</a></code> for details.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A reference to this <code><a class="el" href="classscran_1_1ResidualPca.html" title="Compute PCA after regressing out an uninteresting factor.">ResidualPca</a></code> instance. </dd></dl>

</div>
</div>
<a id="a352355b0cdd190b5829239ac9c80dd94" name="a352355b0cdd190b5829239ac9c80dd94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a352355b0cdd190b5829239ac9c80dd94">&#9670;&#160;</a></span>set_return_rotation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran_1_1ResidualPca.html">ResidualPca</a> &amp; scran::ResidualPca::set_return_rotation </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>r</em> = <code><a class="el" href="structscran_1_1ResidualPca_1_1Defaults.html#a28c4016fe15012de3bf8b73e5b53bc9b">Defaults::return_rotation</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">r</td><td>Should the rotation matrix be returned in the output?</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A reference to this <code><a class="el" href="classscran_1_1ResidualPca.html" title="Compute PCA after regressing out an uninteresting factor.">ResidualPca</a></code> instance. </dd></dl>

</div>
</div>
<a id="af9ce7a7e950c2d77c6dea583f2e8c05c" name="af9ce7a7e950c2d77c6dea583f2e8c05c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9ce7a7e950c2d77c6dea583f2e8c05c">&#9670;&#160;</a></span>set_return_center()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran_1_1ResidualPca.html">ResidualPca</a> &amp; scran::ResidualPca::set_return_center </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>r</em> = <code><a class="el" href="structscran_1_1ResidualPca_1_1Defaults.html#aa6ddf96e0cd7f882e14056a82c25c1bf">Defaults::return_center</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">c</td><td>Should the center vector be returned in the output?</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A reference to this <code><a class="el" href="classscran_1_1ResidualPca.html" title="Compute PCA after regressing out an uninteresting factor.">ResidualPca</a></code> instance. </dd></dl>

</div>
</div>
<a id="a6165921f6bff7b76132c7b731b6f743a" name="a6165921f6bff7b76132c7b731b6f743a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6165921f6bff7b76132c7b731b6f743a">&#9670;&#160;</a></span>set_return_scale()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran_1_1ResidualPca.html">ResidualPca</a> &amp; scran::ResidualPca::set_return_scale </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>r</em> = <code><a class="el" href="structscran_1_1ResidualPca_1_1Defaults.html#a3c10dbaa4c5cb0aa54a7ac4f0c70c186">Defaults::return_scale</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">c</td><td>Should the scale vector be returned in the output?</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A reference to this <code><a class="el" href="classscran_1_1ResidualPca.html" title="Compute PCA after regressing out an uninteresting factor.">ResidualPca</a></code> instance. </dd></dl>

</div>
</div>
<a id="ac000899a60ede0cbaa32c6704d05f80a" name="ac000899a60ede0cbaa32c6704d05f80a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac000899a60ede0cbaa32c6704d05f80a">&#9670;&#160;</a></span>set_num_threads()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran_1_1ResidualPca.html">ResidualPca</a> &amp; scran::ResidualPca::set_num_threads </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em> = <code><a class="el" href="structscran_1_1ResidualPca_1_1Defaults.html#aa39b75d211b4278a58ff86879a2d1e78">Defaults::num_threads</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>Number of threads to use. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A reference to this <code><a class="el" href="classscran_1_1ResidualPca.html" title="Compute PCA after regressing out an uninteresting factor.">ResidualPca</a></code> instance. </dd></dl>

</div>
</div>
<a id="a58b14f9c25cdc6aa1e0c075a2b37f9c1" name="a58b14f9c25cdc6aa1e0c075a2b37f9c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58b14f9c25cdc6aa1e0c075a2b37f9c1">&#9670;&#160;</a></span>run() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Data_ , typename Index_ , typename Block_ &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structscran_1_1ResidualPca_1_1Results.html">Results</a> scran::ResidualPca::run </td>
          <td>(</td>
          <td class="paramtype">const tatami::Matrix&lt; Data_, Index_ &gt; *&#160;</td>
          <td class="paramname"><em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Block_ *&#160;</td>
          <td class="paramname"><em>block</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Run the blocked PCA on an input gene-by-cell matrix.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Data_</td><td>Floating point type for the data. </td></tr>
    <tr><td class="paramname">Index_</td><td>Integer type for the indices. </td></tr>
    <tr><td class="paramname">Block_</td><td>Integer type for the blocking factor.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mat</td><td>Pointer to the input matrix. Columns should contain cells while rows should contain genes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">block</td><td>Pointer to an array of length equal to the number of cells, containing the block assignment for each cell - see <code><a class="el" href="namespacescran.html#a4ad7ef476e1d9852cb9b9b53a46eb63c">count_blocks()</a></code> for details.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <code><a class="el" href="structscran_1_1ResidualPca_1_1Results.html" title="Container for the PCA results.">Results</a></code> object containing the PCs and the variance explained. </dd></dl>

</div>
</div>
<a id="a9e18e6391f88d2b52f612e10a77a1fee" name="a9e18e6391f88d2b52f612e10a77a1fee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e18e6391f88d2b52f612e10a77a1fee">&#9670;&#160;</a></span>run() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Data_ , typename Index_ , typename Block_ , typename Subset_ &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structscran_1_1ResidualPca_1_1Results.html">Results</a> scran::ResidualPca::run </td>
          <td>(</td>
          <td class="paramtype">const tatami::Matrix&lt; Data_, Index_ &gt; *&#160;</td>
          <td class="paramname"><em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Block_ *&#160;</td>
          <td class="paramname"><em>block</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Subset_ *&#160;</td>
          <td class="paramname"><em>features</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Run the blocked PCA on an input gene-by-cell matrix after filtering for genes of interest. We typically use the set of highly variable genes from <code><a class="el" href="classscran_1_1ChooseHVGs.html" title="Choose highly variable genes for downstream analyses.">ChooseHVGs</a></code>, with the aim being to improve computational efficiency and avoid random noise by removing lowly variable genes.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Data_</td><td>Floating point type for the data. </td></tr>
    <tr><td class="paramname">Index_</td><td>Integer type for the indices. </td></tr>
    <tr><td class="paramname">Block_</td><td>Integer type for the blocking factor. </td></tr>
    <tr><td class="paramname">Subset_</td><td>Integer type for the feature filter.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mat</td><td>Pointer to the input matrix. Columns should contain cells while rows should contain genes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">block</td><td>Pointer to an array of length equal to the number of cells, containing the block assignment for each cell - see <code><a class="el" href="namespacescran.html#a4ad7ef476e1d9852cb9b9b53a46eb63c">count_blocks()</a></code> for details. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">features</td><td>Pointer to an array of length equal to the number of genes. Each entry is a boolean specifying whether the corresponding gene should be used in the PCA.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <code><a class="el" href="structscran_1_1ResidualPca_1_1Results.html" title="Container for the PCA results.">Results</a></code> object containing the PCs and the variance explained. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>scran/dimensionality_reduction/<a class="el" href="ResidualPca_8hpp_source.html">ResidualPca.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7
</small></address>
</body>
</html>
