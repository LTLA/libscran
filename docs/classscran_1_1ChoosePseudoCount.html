<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>scran: scran::ChoosePseudoCount Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">scran
   </div>
   <div id="projectbrief">C++ library for basic single-cell RNA-seq analyses</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescran.html">scran</a></li><li class="navelem"><a class="el" href="classscran_1_1ChoosePseudoCount.html">ChoosePseudoCount</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classscran_1_1ChoosePseudoCount-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">scran::ChoosePseudoCount Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Choose a pseudo-count for log-transformation.  
 <a href="classscran_1_1ChoosePseudoCount.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="ChoosePseudoCount_8hpp_source.html">ChoosePseudoCount.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran_1_1ChoosePseudoCount_1_1Defaults.html">Defaults</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default parameters.  <a href="structscran_1_1ChoosePseudoCount_1_1Defaults.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a257d4a27db14c1f143dfd65bdba04105" id="r_a257d4a27db14c1f143dfd65bdba04105"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classscran_1_1ChoosePseudoCount.html">ChoosePseudoCount</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran_1_1ChoosePseudoCount.html#a257d4a27db14c1f143dfd65bdba04105">set_quantile</a> (double q=<a class="el" href="structscran_1_1ChoosePseudoCount_1_1Defaults.html#a15e134c0fd9cbf7b5fb879ff84d9605d">Defaults::quantile</a>)</td></tr>
<tr class="separator:a257d4a27db14c1f143dfd65bdba04105"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a054fd10221e0ee226294f3bd6bdf2af4" id="r_a054fd10221e0ee226294f3bd6bdf2af4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classscran_1_1ChoosePseudoCount.html">ChoosePseudoCount</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran_1_1ChoosePseudoCount.html#a054fd10221e0ee226294f3bd6bdf2af4">set_max_bias</a> (double b=<a class="el" href="structscran_1_1ChoosePseudoCount_1_1Defaults.html#a197babeb9eba67c95191621082c902a0">Defaults::max_bias</a>)</td></tr>
<tr class="separator:a054fd10221e0ee226294f3bd6bdf2af4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0da8c3a4e5a20645c52c99f4a8b42dd6" id="r_a0da8c3a4e5a20645c52c99f4a8b42dd6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classscran_1_1ChoosePseudoCount.html">ChoosePseudoCount</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran_1_1ChoosePseudoCount.html#a0da8c3a4e5a20645c52c99f4a8b42dd6">set_min_value</a> (double v=<a class="el" href="structscran_1_1ChoosePseudoCount_1_1Defaults.html#a41f4c1003ef9d4bd088f61d1dfee40fa">Defaults::min_value</a>)</td></tr>
<tr class="separator:a0da8c3a4e5a20645c52c99f4a8b42dd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f0f0bb26866e5f2f952dd755e1809c7" id="r_a7f0f0bb26866e5f2f952dd755e1809c7"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran_1_1ChoosePseudoCount.html#a7f0f0bb26866e5f2f952dd755e1809c7">run</a> (size_t n, const double *size_factors, double *buffer) const</td></tr>
<tr class="separator:a7f0f0bb26866e5f2f952dd755e1809c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a226eb86ce8a58d55b6a0a9d54cc51b9f" id="r_a226eb86ce8a58d55b6a0a9d54cc51b9f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran_1_1ChoosePseudoCount.html#a226eb86ce8a58d55b6a0a9d54cc51b9f">run</a> (size_t n, const double *size_factors) const</td></tr>
<tr class="separator:a226eb86ce8a58d55b6a0a9d54cc51b9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Choose a pseudo-count for log-transformation. </p>
<p>This class chooses a pseudo-count for log-transformation (see <code><a class="el" href="classscran_1_1LogNormCounts.html#aee1bffa7e408c11cb003d3bef341af09">LogNormCounts::set_pseudo_count()</a></code>) that aims to control the log-transform bias. Specifically, the log-transform can introduce spurious differences in the expected log-normalized expression between cells with very different size factors. This bias can be mitigated by increasing the pseudo-count, which effectively shrinks all log-expression values towards the zero-expression baseline. The increased shrinkage is strongest at low counts where the log-transform bias is most pronounced, while the transformation of large counts is mostly unaffected.</p>
<p>In practice, the log-transformation bias is modest in datasets where there are stronger sources of variation. When observed, it manifests as a library size-dependent trend in the log-normalized expression values. This is difficult to regress out without also removing biology that is associated with, e.g., total RNA content; rather, a simpler solution is to increase the pseudo-count to suppress the bias.</p>
<p>No centering is performed by this function, so if centering is required, the size factors should be used in <code><a class="el" href="classscran_1_1CenterSizeFactors.html" title="Center size factors prior to scaling normalization.">CenterSizeFactors</a></code> first.</p>
<dl class="section see"><dt>See also</dt><dd>Lun ATL (2018). Overcoming systematic errors caused by log-transformation of normalized single-cell RNA sequencing data <em>biorXiv</em> doi:10.1101/404962 </dd></dl>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a257d4a27db14c1f143dfd65bdba04105" name="a257d4a27db14c1f143dfd65bdba04105"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a257d4a27db14c1f143dfd65bdba04105">&#9670;&#160;</a></span>set_quantile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran_1_1ChoosePseudoCount.html">ChoosePseudoCount</a> &amp; scran::ChoosePseudoCount::set_quantile </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>q</em> = <code><a class="el" href="structscran_1_1ChoosePseudoCount_1_1Defaults.html#a15e134c0fd9cbf7b5fb879ff84d9605d">Defaults::quantile</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">q</td><td>Quantile to use for finding the smallest/largest size factors. Setting this to zero will use the observed minimum and maximum, though this is usually too extreme in practice. The default is to take the 5th and 95th percentile, yielding a range that is still representative of most cells.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Reference to this <code><a class="el" href="classscran_1_1ChoosePseudoCount.html" title="Choose a pseudo-count for log-transformation.">ChoosePseudoCount</a></code> class. </dd></dl>

</div>
</div>
<a id="a054fd10221e0ee226294f3bd6bdf2af4" name="a054fd10221e0ee226294f3bd6bdf2af4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a054fd10221e0ee226294f3bd6bdf2af4">&#9670;&#160;</a></span>set_max_bias()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran_1_1ChoosePseudoCount.html">ChoosePseudoCount</a> &amp; scran::ChoosePseudoCount::set_max_bias </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b</em> = <code><a class="el" href="structscran_1_1ChoosePseudoCount_1_1Defaults.html#a197babeb9eba67c95191621082c902a0">Defaults::max_bias</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td>Acceptable upper bound on the log-transformation bias.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Reference to this <code><a class="el" href="classscran_1_1ChoosePseudoCount.html" title="Choose a pseudo-count for log-transformation.">ChoosePseudoCount</a></code> class. </dd></dl>

</div>
</div>
<a id="a0da8c3a4e5a20645c52c99f4a8b42dd6" name="a0da8c3a4e5a20645c52c99f4a8b42dd6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0da8c3a4e5a20645c52c99f4a8b42dd6">&#9670;&#160;</a></span>set_min_value()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran_1_1ChoosePseudoCount.html">ChoosePseudoCount</a> &amp; scran::ChoosePseudoCount::set_min_value </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>v</em> = <code><a class="el" href="structscran_1_1ChoosePseudoCount_1_1Defaults.html#a41f4c1003ef9d4bd088f61d1dfee40fa">Defaults::min_value</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">v</td><td>Minimum value for the pseudo-count returned by <code><a class="el" href="classscran_1_1ChoosePseudoCount.html#a7f0f0bb26866e5f2f952dd755e1809c7">run()</a></code>. <a class="el" href="structscran_1_1ChoosePseudoCount_1_1Defaults.html" title="Default parameters.">Defaults</a> to 1 to stabilize near-zero normalized expression values, otherwise these manifest as avoid large negative values.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Reference to this <code><a class="el" href="classscran_1_1ChoosePseudoCount.html" title="Choose a pseudo-count for log-transformation.">ChoosePseudoCount</a></code> class. </dd></dl>

</div>
</div>
<a id="a7f0f0bb26866e5f2f952dd755e1809c7" name="a7f0f0bb26866e5f2f952dd755e1809c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f0f0bb26866e5f2f952dd755e1809c7">&#9670;&#160;</a></span>run() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double scran::ChoosePseudoCount::run </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>size_factors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>buffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">n</td><td>Number of size factors. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size_factors</td><td>Pointer to an array of size factors of length <code>n</code>. Values should be positive, and all non-positive values are ignored. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">buffer</td><td>Pointer to an array of length <code>n</code>, to be used as a workspace.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The suggested pseudo-count to control the log-transformation-induced bias below the specified threshold. </dd></dl>

</div>
</div>
<a id="a226eb86ce8a58d55b6a0a9d54cc51b9f" name="a226eb86ce8a58d55b6a0a9d54cc51b9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a226eb86ce8a58d55b6a0a9d54cc51b9f">&#9670;&#160;</a></span>run() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double scran::ChoosePseudoCount::run </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>size_factors</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">n</td><td>Number of size factors. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size_factors</td><td>Pointer to an array of size factors of length <code>n</code>. Values should be positive, and all non-positive values are ignored.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The suggested pseudo-count to control the log-transformation-induced bias below the specified threshold. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>scran/normalization/<a class="el" href="ChoosePseudoCount_8hpp_source.html">ChoosePseudoCount.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
