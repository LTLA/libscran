<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>scran: scran::ProjectNeighborEmbedding Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">scran
   </div>
   <div id="projectbrief">C++ library for basic single-cell RNA-seq analyses</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>scran</b></li><li class="navelem"><a class="el" href="classscran_1_1ProjectNeighborEmbedding.html">ProjectNeighborEmbedding</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classscran_1_1ProjectNeighborEmbedding-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">scran::ProjectNeighborEmbedding Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Project cells into a low-dimensional embedding using neighbors.  
 <a href="classscran_1_1ProjectNeighborEmbedding.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="ProjectNeighborEmbedding_8hpp_source.html">ProjectNeighborEmbedding.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran_1_1ProjectNeighborEmbedding_1_1Defaults.html">Defaults</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default parameter settings.  <a href="structscran_1_1ProjectNeighborEmbedding_1_1Defaults.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a437d78322838f15e0b38c74b8df44ef5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classscran_1_1ProjectNeighborEmbedding.html">ProjectNeighborEmbedding</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran_1_1ProjectNeighborEmbedding.html#a437d78322838f15e0b38c74b8df44ef5">set_num_neighbors</a> (int k=<a class="el" href="structscran_1_1ProjectNeighborEmbedding_1_1Defaults.html#a1447bf873d6f367c40b8b732a735e881">Defaults::num_neighbors</a>)</td></tr>
<tr class="separator:a437d78322838f15e0b38c74b8df44ef5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10ac2910df05a817d0cd8b4001dcb735"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classscran_1_1ProjectNeighborEmbedding.html">ProjectNeighborEmbedding</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran_1_1ProjectNeighborEmbedding.html#a10ac2910df05a817d0cd8b4001dcb735">set_approximate</a> (int a=<a class="el" href="structscran_1_1ProjectNeighborEmbedding_1_1Defaults.html#ae013eb00412da29e28598536c145f03e">Defaults::approximate</a>)</td></tr>
<tr class="separator:a10ac2910df05a817d0cd8b4001dcb735"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0533a39dc93bc59e68f76ae09e551132"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classscran_1_1ProjectNeighborEmbedding.html">ProjectNeighborEmbedding</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran_1_1ProjectNeighborEmbedding.html#a0533a39dc93bc59e68f76ae09e551132">set_num_threads</a> (int n=<a class="el" href="structscran_1_1ProjectNeighborEmbedding_1_1Defaults.html#a9bfe4b576464c8bc2be93ee56d37566c">Defaults::num_threads</a>)</td></tr>
<tr class="separator:a0533a39dc93bc59e68f76ae09e551132"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52e7afdfd26cf4519a1b5fb180285e73"><td class="memTemplParams" colspan="2">template&lt;typename Index , typename Float &gt; </td></tr>
<tr class="memitem:a52e7afdfd26cf4519a1b5fb180285e73"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classscran_1_1ProjectNeighborEmbedding.html#a52e7afdfd26cf4519a1b5fb180285e73">run</a> (int ndim, size_t nref, const Float *ref, size_t ntest, const Float *test, int nembed, const Float *ref_embedding, const std::vector&lt; std::vector&lt; std::pair&lt; Index, Float &gt; &gt; &gt; &amp;neighbors, Float *output) const</td></tr>
<tr class="separator:a52e7afdfd26cf4519a1b5fb180285e73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a757090aa0f7f79830a639a57bcac70f7"><td class="memTemplParams" colspan="2">template&lt;typename Index , typename Float &gt; </td></tr>
<tr class="memitem:a757090aa0f7f79830a639a57bcac70f7"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classscran_1_1ProjectNeighborEmbedding.html#a757090aa0f7f79830a639a57bcac70f7">run</a> (int ndim, size_t nref, const Float *ref, size_t ntest, const Float *test, int nembed, const Float *ref_embedding, const knncolle::Base&lt; Index, Float &gt; *index, Float *output) const</td></tr>
<tr class="separator:a757090aa0f7f79830a639a57bcac70f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2eae1a129d7657ba0d518e9c6bb5d75c"><td class="memTemplParams" colspan="2">template&lt;typename Index  = int, typename Float &gt; </td></tr>
<tr class="memitem:a2eae1a129d7657ba0d518e9c6bb5d75c"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classscran_1_1ProjectNeighborEmbedding.html#a2eae1a129d7657ba0d518e9c6bb5d75c">run</a> (int ndim, size_t nref, const Float *ref, size_t ntest, const Float *test, int nembed, const Float *ref_embedding, Float *output) const</td></tr>
<tr class="separator:a2eae1a129d7657ba0d518e9c6bb5d75c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e9f4bfc255a60bdd244b5491503966b"><td class="memTemplParams" colspan="2">template&lt;typename Index  = int, typename Float &gt; </td></tr>
<tr class="memitem:a1e9f4bfc255a60bdd244b5491503966b"><td class="memTemplItemLeft" align="right" valign="top">std::vector&lt; Float &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classscran_1_1ProjectNeighborEmbedding.html#a1e9f4bfc255a60bdd244b5491503966b">run</a> (int ndim, size_t nref, const Float *ref, size_t ntest, const Float *test, int nembed, const Float *ref_embedding) const</td></tr>
<tr class="separator:a1e9f4bfc255a60bdd244b5491503966b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Project cells into a low-dimensional embedding using neighbors. </p>
<p >This class projects cells into a "destination" embedding based on their neighbors in another "source" embedding. It is primarily intended for mapping cells in a test dataset onto a 2-dimensional visualization generated from a reference dataset, after detecting the nearest neighbors in the reference for each test cell in PC space. For example, we could downsample a dataset with <code><a class="el" href="classscran_1_1DownsampleByNeighbors.html" title="Downsample a dataset based on its neighbors.">DownsampleByNeighbors</a></code>, generate a 2D visualization for the subset from the PCs, and then use <code><a class="el" href="classscran_1_1ProjectNeighborEmbedding.html" title="Project cells into a low-dimensional embedding using neighbors.">ProjectNeighborEmbedding</a></code> to project all cells onto the visualization.</p>
<p >The projected location in the destination embedding for each test cell is determined by voting for its best neighbor. For each test cell, we find all of its "primary" neighbors in the source embedding. For each primary neighbor, we examine its own nearest neighbors in the destination embedding. For that set of neighbor's neighbors, we compute the distance to the test cell, and we convert that into a weight using a Gaussian kernel. Summation of the weights yields a score for the primary neighbor; the primary neighbor with the highest score is elected as the projection location.</p>
<p >This approach avoids introducing any artifacts in the destination embedding. In particular, we avoid the formation of spurious intermediate populations, which is common when naively averaging the destination coordinates of the primary neighbors. This is because many embedding algorithms will separate primary neighbors in the destination embedding, such that an average will not be close to any of those neighbors. Additionally, we do not jitter the test cells around the elected primary neighbor, as this forms visually distracting clumps when many test cells elect the same primary neighbor. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a1e9f4bfc255a60bdd244b5491503966b" name="a1e9f4bfc255a60bdd244b5491503966b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e9f4bfc255a60bdd244b5491503966b">&#9670;&nbsp;</a></span>run() <span class="overload">[1/4]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Index  = int, typename Float &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; Float &gt; scran::ProjectNeighborEmbedding::run </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>nref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Float *&#160;</td>
          <td class="paramname"><em>ref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>ntest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Float *&#160;</td>
          <td class="paramname"><em>test</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nembed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Float *&#160;</td>
          <td class="paramname"><em>ref_embedding</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Index</td><td>Integer type for the indices. </td></tr>
    <tr><td class="paramname">Float</td><td>Floating point type for distances and embeddings.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">ndim</td><td>Number of dimensions in the source embedding. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">nref</td><td>Number of cells in the reference dataset. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ref</td><td>Pointer to a column-major array of coordinates of dimensions (rows) and cells (columns) for the source embedding of the reference dataset. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ntest</td><td>Number of cells in the test dataset. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ref</td><td>Pointer to a column-major array of coordinates of dimensions (rows) and cells (columns) for the source embedding of the test dataset. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">nembed</td><td>Number of dimensions of the destination embedding. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ref_embedding</td><td>Pointer to a column-major array of dimensions (rows) and cells (columns), containing coordinates of the destination embedding for the reference dataset.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Vector containing the projected coordinates in the destination embedding for the test dataset. This should be interpreted as a column-major array with number of rows and columns equal to <code>nembed</code> and <code>neighbors.size()</code>, respectively. </dd></dl>

</div>
</div>
<a id="a757090aa0f7f79830a639a57bcac70f7" name="a757090aa0f7f79830a639a57bcac70f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a757090aa0f7f79830a639a57bcac70f7">&#9670;&nbsp;</a></span>run() <span class="overload">[2/4]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Index , typename Float &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void scran::ProjectNeighborEmbedding::run </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>nref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Float *&#160;</td>
          <td class="paramname"><em>ref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>ntest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Float *&#160;</td>
          <td class="paramname"><em>test</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nembed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Float *&#160;</td>
          <td class="paramname"><em>ref_embedding</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const knncolle::Base&lt; Index, Float &gt; *&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Float *&#160;</td>
          <td class="paramname"><em>output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Index</td><td>Integer type for the indices. </td></tr>
    <tr><td class="paramname">Float</td><td>Floating point type for distances and embeddings.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">index</td><td>Pointer to a <code>knncolle::Base</code> object containing a neighbor search index for the reference dataset, constructed from the source embedding. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">nembed</td><td>Number of dimensions of the destination embedding. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ref_embedding</td><td>Pointer to a column-major array of dimensions (rows) and cells (columns), containing coordinates of the destination embedding for the reference dataset. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">output</td><td>Pointer to a column-major array of dimensions (rows) and cells (columns), to be filled with the projected coordinates in the destination embedding for the test dataset. This should have number of rows and columns equal to <code>nembed</code> and <code>neighbors.size()</code>, respectively. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a52e7afdfd26cf4519a1b5fb180285e73" name="a52e7afdfd26cf4519a1b5fb180285e73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52e7afdfd26cf4519a1b5fb180285e73">&#9670;&nbsp;</a></span>run() <span class="overload">[3/4]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Index , typename Float &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void scran::ProjectNeighborEmbedding::run </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>nref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Float *&#160;</td>
          <td class="paramname"><em>ref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>ntest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Float *&#160;</td>
          <td class="paramname"><em>test</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nembed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Float *&#160;</td>
          <td class="paramname"><em>ref_embedding</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; std::pair&lt; Index, Float &gt; &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>neighbors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Float *&#160;</td>
          <td class="paramname"><em>output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Index</td><td>Integer type for the indices. </td></tr>
    <tr><td class="paramname">Float</td><td>Floating point type for distances and embeddings.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">neighhbors</td><td>Vector of vectors of neighbors for each cell in the test dataset. Each entry of the outer vector corresponds to a test cell while each entry of the inner vector contains the index of and distance to a neighboring cell in the reference dataset. Inner vectors should be sorted by increasing distance. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">nembed</td><td>Number of dimensions of the destination embedding. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ref_embedding</td><td>Pointer to a column-major array of dimensions (rows) and cells (columns), containing coordinates of the destination embedding for the reference dataset. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">output</td><td>Pointer to a column-major array of dimensions (rows) and cells (columns), to be filled with the projected coordinates in the destination embedding for the test dataset. This should have number of rows and columns equal to <code>nembed</code> and <code>neighbors.size()</code>, respectively. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a2eae1a129d7657ba0d518e9c6bb5d75c" name="a2eae1a129d7657ba0d518e9c6bb5d75c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2eae1a129d7657ba0d518e9c6bb5d75c">&#9670;&nbsp;</a></span>run() <span class="overload">[4/4]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Index  = int, typename Float &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void scran::ProjectNeighborEmbedding::run </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>nref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Float *&#160;</td>
          <td class="paramname"><em>ref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>ntest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Float *&#160;</td>
          <td class="paramname"><em>test</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nembed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Float *&#160;</td>
          <td class="paramname"><em>ref_embedding</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Float *&#160;</td>
          <td class="paramname"><em>output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Index</td><td>Integer type for the indices. </td></tr>
    <tr><td class="paramname">Float</td><td>Floating point type for distances and embeddings.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">ndim</td><td>Number of dimensions in the source embedding. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">nref</td><td>Number of cells in the reference dataset. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ref</td><td>Pointer to a column-major array of coordinates of dimensions (rows) and cells (columns) for the source embedding of the reference dataset. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ntest</td><td>Number of cells in the test dataset. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ref</td><td>Pointer to a column-major array of coordinates of dimensions (rows) and cells (columns) for the source embedding of the test dataset. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">nembed</td><td>Number of dimensions of the destination embedding. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ref_embedding</td><td>Pointer to a column-major array of dimensions (rows) and cells (columns), containing coordinates of the destination embedding for the reference dataset. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">output</td><td>Pointer to a column-major array of dimensions (rows) and cells (columns), to be filled with the projected coordinates in the destination embedding for the test dataset. This should have number of rows and columns equal to <code>nembed</code> and <code>neighbors.size()</code>, respectively. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a10ac2910df05a817d0cd8b4001dcb735" name="a10ac2910df05a817d0cd8b4001dcb735"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10ac2910df05a817d0cd8b4001dcb735">&#9670;&nbsp;</a></span>set_approximate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran_1_1ProjectNeighborEmbedding.html">ProjectNeighborEmbedding</a> &amp; scran::ProjectNeighborEmbedding::set_approximate </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>a</em> = <code><a class="el" href="structscran_1_1ProjectNeighborEmbedding_1_1Defaults.html#ae013eb00412da29e28598536c145f03e">Defaults::approximate</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>Whether an approximate neighbor search should be performed.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A reference to this <code><a class="el" href="classscran_1_1ProjectNeighborEmbedding.html" title="Project cells into a low-dimensional embedding using neighbors.">ProjectNeighborEmbedding</a></code> object. </dd></dl>

</div>
</div>
<a id="a437d78322838f15e0b38c74b8df44ef5" name="a437d78322838f15e0b38c74b8df44ef5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a437d78322838f15e0b38c74b8df44ef5">&#9670;&nbsp;</a></span>set_num_neighbors()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran_1_1ProjectNeighborEmbedding.html">ProjectNeighborEmbedding</a> &amp; scran::ProjectNeighborEmbedding::set_num_neighbors </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>k</em> = <code><a class="el" href="structscran_1_1ProjectNeighborEmbedding_1_1Defaults.html#a1447bf873d6f367c40b8b732a735e881">Defaults::num_neighbors</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">k</td><td>Number of neighbors to use for projection. Larger values improve stability but increase the risk of including irrelevant neighbors.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A reference to this <code><a class="el" href="classscran_1_1ProjectNeighborEmbedding.html" title="Project cells into a low-dimensional embedding using neighbors.">ProjectNeighborEmbedding</a></code> object.</dd></dl>
<p>Note that this parameter only has an effect in <code><a class="el" href="classscran_1_1ProjectNeighborEmbedding.html#a52e7afdfd26cf4519a1b5fb180285e73">run()</a></code> methods that do not accept a list of precomputed neighbors, in which case the number of neighbors is taken from the list. </p>

</div>
</div>
<a id="a0533a39dc93bc59e68f76ae09e551132" name="a0533a39dc93bc59e68f76ae09e551132"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0533a39dc93bc59e68f76ae09e551132">&#9670;&nbsp;</a></span>set_num_threads()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran_1_1ProjectNeighborEmbedding.html">ProjectNeighborEmbedding</a> &amp; scran::ProjectNeighborEmbedding::set_num_threads </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em> = <code><a class="el" href="structscran_1_1ProjectNeighborEmbedding_1_1Defaults.html#a9bfe4b576464c8bc2be93ee56d37566c">Defaults::num_threads</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>Number of threads to use.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A reference to this <code><a class="el" href="classscran_1_1ProjectNeighborEmbedding.html" title="Project cells into a low-dimensional embedding using neighbors.">ProjectNeighborEmbedding</a></code> object. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>scran/dimensionality_reduction/<a class="el" href="ProjectNeighborEmbedding_8hpp_source.html">ProjectNeighborEmbedding.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
