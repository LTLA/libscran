<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>scran: scran/clustering/ClusterSNNGraph.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">scran
   </div>
   <div id="projectbrief">C++ library for basic single-cell RNA-seq analyses</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_bdabb9492db2368b3caf0f4c1df6a160.html">scran</a></li><li class="navelem"><a class="el" href="dir_b9c0c73449df2552798dd527c166079a.html">clustering</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">ClusterSNNGraph.hpp</div></div>
</div><!--header-->
<div class="contents">
<a href="ClusterSNNGraph_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="preprocessor">#ifndef SCRAN_SNNGRAPHCLUSTERING_HPP</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="preprocessor">#define SCRAN_SNNGRAPHCLUSTERING_HPP</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span> </div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="preprocessor">#ifndef SCRAN_EXCLUDE_IGRAPH</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span> </div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="preprocessor">#include &quot;<a class="code" href="BuildSNNGraph_8hpp.html">BuildSNNGraph.hpp</a>&quot;</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span> </div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span> </div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="preprocessor">#include &quot;igraph.h&quot;</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span> </div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="keyword">namespace </span>scran {</div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span> </div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno"><a class="line" href="classscran_1_1ClusterSNNGraph.html">   27</a></span><span class="keyword">class </span><a class="code hl_class" href="classscran_1_1ClusterSNNGraph.html">ClusterSNNGraph</a> {</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="keyword">protected</span>:</div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span>    <a class="code hl_class" href="classscran_1_1BuildSNNGraph.html">BuildSNNGraph</a> builder;</div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span> </div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno"><a class="line" href="structscran_1_1ClusterSNNGraph_1_1Graph.html">   37</a></span>    <span class="keyword">struct </span><a class="code hl_struct" href="structscran_1_1ClusterSNNGraph_1_1Graph.html">Graph</a> {</div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno"><a class="line" href="structscran_1_1ClusterSNNGraph_1_1Graph.html#a705ba30639aae97157d20e468294efe2">   41</a></span>        igraph_t <a class="code hl_variable" href="structscran_1_1ClusterSNNGraph_1_1Graph.html#a705ba30639aae97157d20e468294efe2">graph</a>;</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span> </div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno"><a class="line" href="structscran_1_1ClusterSNNGraph_1_1Graph.html#a1c0c132d946cf3883956168bea6f30f2">   46</a></span>        igraph_vector_t <a class="code hl_variable" href="structscran_1_1ClusterSNNGraph_1_1Graph.html#a1c0c132d946cf3883956168bea6f30f2">weights</a>;</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span> </div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno"><a class="line" href="structscran_1_1ClusterSNNGraph_1_1Graph.html#a0d7cf0747ed7bff0c4e810dcbd77ebdb">   51</a></span>        <span class="keywordtype">void</span> <a class="code hl_function" href="structscran_1_1ClusterSNNGraph_1_1Graph.html#a0d7cf0747ed7bff0c4e810dcbd77ebdb">destroy</a>() {</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>            igraph_destroy(&amp;<a class="code hl_variable" href="structscran_1_1ClusterSNNGraph_1_1Graph.html#a705ba30639aae97157d20e468294efe2">graph</a>);</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>            igraph_vector_destroy(&amp;<a class="code hl_variable" href="structscran_1_1ClusterSNNGraph_1_1Graph.html#a1c0c132d946cf3883956168bea6f30f2">weights</a>);</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>        }</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>    };</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span> </div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno"><a class="line" href="classscran_1_1ClusterSNNGraph.html#a613d3b3cd5c6ab31848f8c0e2084ca89">   68</a></span>    <a class="code hl_struct" href="structscran_1_1ClusterSNNGraph_1_1Graph.html">Graph</a> <a class="code hl_function" href="classscran_1_1ClusterSNNGraph.html#a613d3b3cd5c6ab31848f8c0e2084ca89">build</a>(<span class="keywordtype">size_t</span> ndims, <span class="keywordtype">size_t</span> ncells, <span class="keyword">const</span> <span class="keywordtype">double</span>* mat)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>        <span class="keyword">auto</span> store = builder.<a class="code hl_function" href="classscran_1_1BuildSNNGraph.html#a6f2a0276125b2f8426afecb32cd7080e">run</a>(ndims, ncells, mat);</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="classscran_1_1ClusterSNNGraph.html#a613d3b3cd5c6ab31848f8c0e2084ca89">build</a>(ncells, store);</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>    }</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span> </div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>    <span class="keyword">template</span>&lt;<span class="keyword">class</span> Algorithm&gt;</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno"><a class="line" href="classscran_1_1ClusterSNNGraph.html#aa777f85140bac6998e060838adf6c6bf">   83</a></span>    <a class="code hl_struct" href="structscran_1_1ClusterSNNGraph_1_1Graph.html">Graph</a> <a class="code hl_function" href="classscran_1_1ClusterSNNGraph.html#aa777f85140bac6998e060838adf6c6bf">build</a>(<span class="keyword">const</span> Algorithm* search)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>        <span class="keyword">auto</span> store = builder.<a class="code hl_function" href="classscran_1_1BuildSNNGraph.html#a6f2a0276125b2f8426afecb32cd7080e">run</a>(search);</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="classscran_1_1ClusterSNNGraph.html#a613d3b3cd5c6ab31848f8c0e2084ca89">build</a>(search-&gt;nobs(), store);</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>    }</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span> </div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno"><a class="line" href="classscran_1_1ClusterSNNGraph.html#a86208b4b339d88e3a93ef9ead03ef2bb">   96</a></span>    <a class="code hl_struct" href="structscran_1_1ClusterSNNGraph_1_1Graph.html">Graph</a> <a class="code hl_function" href="classscran_1_1ClusterSNNGraph.html#a86208b4b339d88e3a93ef9ead03ef2bb">build</a>(<span class="keywordtype">size_t</span> ncells, <span class="keyword">const</span> std::deque&lt;BuildSNNGraph::WeightedEdge&gt;&amp; store)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span><span class="preprocessor">#ifdef SCRAN_LOGGER</span></div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>        SCRAN_LOGGER(<span class="stringliteral">&quot;scran::ClusterSNNGraph&quot;</span>, <span class="stringliteral">&quot;Filling the graph object&quot;</span>);</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>        <a class="code hl_struct" href="structscran_1_1ClusterSNNGraph_1_1Graph.html">Graph</a> output;</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>        igraph_vector_t edges;</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>        igraph_vector_init(&amp;edges, store.size() * 2);</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span> </div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>        igraph_vector_t&amp; weights = output.<a class="code hl_variable" href="structscran_1_1ClusterSNNGraph_1_1Graph.html#a1c0c132d946cf3883956168bea6f30f2">weights</a>;</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>        igraph_vector_init(&amp;weights, store.size());</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span> </div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>        <span class="keywordtype">size_t</span> counter = 0;</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; store.size(); ++i, counter += 2) { <span class="comment">// not entirely sure it&#39;s safe to use std::copy here.</span></div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>            <span class="keyword">const</span> <span class="keyword">auto</span>&amp; edge = store[i];</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>            VECTOR(edges)[counter] = std::get&lt;0&gt;(edge);</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>            VECTOR(edges)[counter + 1] = std::get&lt;1&gt;(edge);</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>            VECTOR(weights)[i] = std::get&lt;2&gt;(edge);</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>        }</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span> </div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>        igraph_create(&amp;(output.<a class="code hl_variable" href="structscran_1_1ClusterSNNGraph_1_1Graph.html#a705ba30639aae97157d20e468294efe2">graph</a>), &amp;edges, ncells, 0); </div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>        igraph_vector_destroy(&amp;edges);</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span> </div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>        <span class="keywordflow">return</span> output;</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>    }</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>};</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span> </div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno"><a class="line" href="classscran_1_1ClusterSNNGraphMultiLevel.html">  128</a></span><span class="keyword">class </span><a class="code hl_class" href="classscran_1_1ClusterSNNGraphMultiLevel.html">ClusterSNNGraphMultiLevel</a> : <span class="keyword">public</span> <a class="code hl_class" href="classscran_1_1ClusterSNNGraph.html">ClusterSNNGraph</a> {</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno"><a class="line" href="structscran_1_1ClusterSNNGraphMultiLevel_1_1Defaults.html">  133</a></span>    <span class="keyword">struct </span><a class="code hl_struct" href="structscran_1_1ClusterSNNGraphMultiLevel_1_1Defaults.html">Defaults</a> {</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno"><a class="line" href="structscran_1_1ClusterSNNGraphMultiLevel_1_1Defaults.html#ac9eb6ed103b706b87b81050ac6ad4cc1">  137</a></span>        <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="structscran_1_1ClusterSNNGraphMultiLevel_1_1Defaults.html#ac9eb6ed103b706b87b81050ac6ad4cc1">resolution</a> = 1;</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span> </div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno"><a class="line" href="structscran_1_1ClusterSNNGraphMultiLevel_1_1Defaults.html#ad3584684d404d382240a908bd88df606">  142</a></span>        <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="structscran_1_1ClusterSNNGraphMultiLevel_1_1Defaults.html#ad3584684d404d382240a908bd88df606">seed</a> = 42;</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>    };</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span> </div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span><span class="keyword">private</span>:</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>    <span class="keywordtype">double</span> resolution = <a class="code hl_variable" href="structscran_1_1ClusterSNNGraphMultiLevel_1_1Defaults.html#ac9eb6ed103b706b87b81050ac6ad4cc1">Defaults::resolution</a>;</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>    <span class="keywordtype">int</span> seed = <a class="code hl_variable" href="structscran_1_1ClusterSNNGraphMultiLevel_1_1Defaults.html#ad3584684d404d382240a908bd88df606">Defaults::seed</a>;</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span> </div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno"><a class="line" href="classscran_1_1ClusterSNNGraphMultiLevel.html#ae759e205c202313ea7f91262216b5d8e">  155</a></span>    <a class="code hl_class" href="classscran_1_1ClusterSNNGraphMultiLevel.html">ClusterSNNGraphMultiLevel</a>&amp; <a class="code hl_function" href="classscran_1_1ClusterSNNGraphMultiLevel.html#ae759e205c202313ea7f91262216b5d8e">set_neighbors</a>(<span class="keywordtype">int</span> k = <a class="code hl_variable" href="structscran_1_1BuildSNNGraph_1_1Defaults.html#a6a376b256377055e23a96c3d9eb96365">BuildSNNGraph::Defaults::neighbors</a>) {</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>        builder.<a class="code hl_function" href="classscran_1_1BuildSNNGraph.html#a22b16cc067f034eecc097b79b903a017">set_neighbors</a>(k);</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>    }</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span> </div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno"><a class="line" href="classscran_1_1ClusterSNNGraphMultiLevel.html#a87a7d6037f87883d36b1a25b0f550fdb">  165</a></span>    <a class="code hl_class" href="classscran_1_1ClusterSNNGraphMultiLevel.html">ClusterSNNGraphMultiLevel</a>&amp; <a class="code hl_function" href="classscran_1_1ClusterSNNGraphMultiLevel.html#a87a7d6037f87883d36b1a25b0f550fdb">set_approximate</a>(<span class="keywordtype">bool</span> a = <a class="code hl_variable" href="structscran_1_1BuildSNNGraph_1_1Defaults.html#af6d0a1c84cd739442a6767171e0202e0">BuildSNNGraph::Defaults::approximate</a>) {</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>        builder.<a class="code hl_function" href="classscran_1_1BuildSNNGraph.html#ac5085b513afa0e47617833e7279c61cb">set_approximate</a>(a);</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>    }</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span> </div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno"><a class="line" href="classscran_1_1ClusterSNNGraphMultiLevel.html#a4e8e613827e91b3143fac08132433481">  175</a></span>    <a class="code hl_class" href="classscran_1_1ClusterSNNGraphMultiLevel.html">ClusterSNNGraphMultiLevel</a>&amp; <a class="code hl_function" href="classscran_1_1ClusterSNNGraphMultiLevel.html#a4e8e613827e91b3143fac08132433481">set_weighting_scheme</a>(<a class="code hl_enumeration" href="classscran_1_1BuildSNNGraph.html#ae7e2167f6c3cf02432a3cdc6e4583e2a">BuildSNNGraph::Scheme</a> s = <a class="code hl_variable" href="structscran_1_1BuildSNNGraph_1_1Defaults.html#a258288cda0e643719d53a834424b56a6">BuildSNNGraph::Defaults::weighting_scheme</a>) {</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>        builder.<a class="code hl_function" href="classscran_1_1BuildSNNGraph.html#a9b2863dda326ce82c1fba43b7660e05a">set_weighting_scheme</a>(s);</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>    }</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span> </div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno"><a class="line" href="classscran_1_1ClusterSNNGraphMultiLevel.html#adf87b496fe1a83e05412c2b530625247">  185</a></span>    <a class="code hl_class" href="classscran_1_1ClusterSNNGraphMultiLevel.html">ClusterSNNGraphMultiLevel</a>&amp; <a class="code hl_function" href="classscran_1_1ClusterSNNGraphMultiLevel.html#adf87b496fe1a83e05412c2b530625247">set_seed</a>(<span class="keywordtype">int</span> s = <a class="code hl_variable" href="structscran_1_1ClusterSNNGraphMultiLevel_1_1Defaults.html#ad3584684d404d382240a908bd88df606">Defaults::seed</a>) {</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>        seed = s;</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>    }</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span> </div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno"><a class="line" href="classscran_1_1ClusterSNNGraphMultiLevel.html#ad8f5902012b6ee4a950123eaeee739e8">  196</a></span>    <a class="code hl_class" href="classscran_1_1ClusterSNNGraphMultiLevel.html">ClusterSNNGraphMultiLevel</a>&amp; <a class="code hl_function" href="classscran_1_1ClusterSNNGraphMultiLevel.html#ad8f5902012b6ee4a950123eaeee739e8">set_resolution</a>(<span class="keywordtype">double</span> r = <a class="code hl_variable" href="structscran_1_1ClusterSNNGraphMultiLevel_1_1Defaults.html#ac9eb6ed103b706b87b81050ac6ad4cc1">Defaults::resolution</a>) {</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>        resolution = r;</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>    }</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span> </div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno"><a class="line" href="structscran_1_1ClusterSNNGraphMultiLevel_1_1Results.html">  208</a></span>    <span class="keyword">struct </span><a class="code hl_struct" href="structscran_1_1ClusterSNNGraphMultiLevel_1_1Results.html">Results</a> {</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno"><a class="line" href="structscran_1_1ClusterSNNGraphMultiLevel_1_1Results.html#ad955a05f5d065e7de84d6c14a8da0564">  213</a></span>        <span class="keywordtype">int</span> <a class="code hl_variable" href="structscran_1_1ClusterSNNGraphMultiLevel_1_1Results.html#ad955a05f5d065e7de84d6c14a8da0564">status</a>;</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>        </div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno"><a class="line" href="structscran_1_1ClusterSNNGraphMultiLevel_1_1Results.html#a569e235d05befc66022b27cf329c1b2d">  219</a></span>        <span class="keywordtype">size_t</span> <a class="code hl_variable" href="structscran_1_1ClusterSNNGraphMultiLevel_1_1Results.html#a569e235d05befc66022b27cf329c1b2d">max</a>;</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span> </div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno"><a class="line" href="structscran_1_1ClusterSNNGraphMultiLevel_1_1Results.html#a27434f77a03c488270b68c08e5105e80">  225</a></span>        std::vector&lt;std::vector&lt;int&gt; &gt; <a class="code hl_variable" href="structscran_1_1ClusterSNNGraphMultiLevel_1_1Results.html#a27434f77a03c488270b68c08e5105e80">membership</a>;</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span> </div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno"><a class="line" href="structscran_1_1ClusterSNNGraphMultiLevel_1_1Results.html#ad24f154bae449495590393bdb2ff59fc">  231</a></span>        std::vector&lt;double&gt; <a class="code hl_variable" href="structscran_1_1ClusterSNNGraphMultiLevel_1_1Results.html#ad24f154bae449495590393bdb2ff59fc">modularity</a>;</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>    };</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span> </div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno"><a class="line" href="classscran_1_1ClusterSNNGraphMultiLevel.html#aee656f0e8b2adce118a2ae16375735a5">  245</a></span>    <a class="code hl_struct" href="structscran_1_1ClusterSNNGraphMultiLevel_1_1Results.html">Results</a> <a class="code hl_function" href="classscran_1_1ClusterSNNGraphMultiLevel.html#aee656f0e8b2adce118a2ae16375735a5">run</a>(<span class="keywordtype">size_t</span> ndims, <span class="keywordtype">size_t</span> ncells, <span class="keyword">const</span> <span class="keywordtype">double</span>* mat) {</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>        <span class="keyword">auto</span> graph_info = <a class="code hl_function" href="classscran_1_1ClusterSNNGraph.html#a613d3b3cd5c6ab31848f8c0e2084ca89">build</a>(ndims, ncells, mat);</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>        <span class="keyword">auto</span> output = <a class="code hl_function" href="classscran_1_1ClusterSNNGraphMultiLevel.html#aee656f0e8b2adce118a2ae16375735a5">run</a>(graph_info);</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>        graph_info.destroy();</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>        <span class="keywordflow">return</span> output;</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>    }</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span> </div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>    <span class="keyword">template</span>&lt;<span class="keyword">class</span> Algorithm&gt;</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno"><a class="line" href="classscran_1_1ClusterSNNGraphMultiLevel.html#ac419751ecdd32e0895eda89f653efcdc">  262</a></span>    <a class="code hl_struct" href="structscran_1_1ClusterSNNGraphMultiLevel_1_1Results.html">Results</a> <a class="code hl_function" href="classscran_1_1ClusterSNNGraphMultiLevel.html#ac419751ecdd32e0895eda89f653efcdc">run</a>(<span class="keyword">const</span> Algorithm* search) {</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>        <span class="keyword">auto</span> graph_info = <a class="code hl_function" href="classscran_1_1ClusterSNNGraph.html#a613d3b3cd5c6ab31848f8c0e2084ca89">build</a>(search);</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>        <span class="keyword">auto</span> output = <a class="code hl_function" href="classscran_1_1ClusterSNNGraphMultiLevel.html#aee656f0e8b2adce118a2ae16375735a5">run</a>(graph_info);</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>        graph_info.destroy();</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>        <span class="keywordflow">return</span> output;</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>    }</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span> </div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno"><a class="line" href="classscran_1_1ClusterSNNGraphMultiLevel.html#a0436cbf1ed96a1f3a825dc7864eb19b1">  277</a></span>    <a class="code hl_struct" href="structscran_1_1ClusterSNNGraphMultiLevel_1_1Results.html">Results</a> <a class="code hl_function" href="classscran_1_1ClusterSNNGraphMultiLevel.html#a0436cbf1ed96a1f3a825dc7864eb19b1">run</a>(<span class="keywordtype">size_t</span> ncells, <span class="keyword">const</span> std::deque&lt;BuildSNNGraph::WeightedEdge&gt;&amp; store) {</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>        <span class="keyword">auto</span> graph_info = <a class="code hl_function" href="classscran_1_1ClusterSNNGraph.html#a613d3b3cd5c6ab31848f8c0e2084ca89">build</a>(ncells, store);</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>        <span class="keyword">auto</span> output = <a class="code hl_function" href="classscran_1_1ClusterSNNGraphMultiLevel.html#aee656f0e8b2adce118a2ae16375735a5">run</a>(graph_info);</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>        graph_info.destroy();</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>        <span class="keywordflow">return</span> output;</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>    }</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span> </div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno"><a class="line" href="classscran_1_1ClusterSNNGraphMultiLevel.html#a28ba7d3aefecb5756728398840f351ec">  291</a></span>    <a class="code hl_struct" href="structscran_1_1ClusterSNNGraphMultiLevel_1_1Results.html">Results</a> <a class="code hl_function" href="classscran_1_1ClusterSNNGraphMultiLevel.html#a28ba7d3aefecb5756728398840f351ec">run</a>(<span class="keyword">const</span> <a class="code hl_struct" href="structscran_1_1ClusterSNNGraph_1_1Graph.html">Graph</a>&amp; graph_info) {</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>        igraph_vector_t membership, modularity;</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>        igraph_matrix_t memberships;</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span> </div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>        igraph_vector_init(&amp;modularity, 0);</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>        igraph_vector_init(&amp;membership, 0);</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>        igraph_matrix_init(&amp;memberships, 0, 0);</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span> </div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>        <span class="comment">// I just can&#39;t be bothered to do anything fancier here, so this is what we&#39;ve got.</span></div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>        igraph_rng_seed(igraph_rng_default(), seed);</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span> </div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span><span class="preprocessor">#ifdef SCRAN_LOGGER</span></div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>        SCRAN_LOGGER(<span class="stringliteral">&quot;scran::ClusterSNNGraph&quot;</span>, <span class="stringliteral">&quot;Performing multilevel community detection&quot;</span>);</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>        <a class="code hl_struct" href="structscran_1_1ClusterSNNGraphMultiLevel_1_1Results.html">Results</a> output;</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>        output.<a class="code hl_variable" href="structscran_1_1ClusterSNNGraphMultiLevel_1_1Results.html#ad955a05f5d065e7de84d6c14a8da0564">status</a> = igraph_community_multilevel(&amp;graph_info.<a class="code hl_variable" href="structscran_1_1ClusterSNNGraph_1_1Graph.html#a705ba30639aae97157d20e468294efe2">graph</a>, &amp;graph_info.<a class="code hl_variable" href="structscran_1_1ClusterSNNGraph_1_1Graph.html#a1c0c132d946cf3883956168bea6f30f2">weights</a>, resolution, &amp;membership, &amp;memberships, &amp;modularity);</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span> </div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>        <span class="keywordflow">if</span> (!output.<a class="code hl_variable" href="structscran_1_1ClusterSNNGraphMultiLevel_1_1Results.html#ad955a05f5d065e7de84d6c14a8da0564">status</a>) {</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>            output.<a class="code hl_variable" href="structscran_1_1ClusterSNNGraphMultiLevel_1_1Results.html#a569e235d05befc66022b27cf329c1b2d">max</a> = igraph_vector_which_max(&amp;modularity);</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span> </div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>            <span class="keywordtype">size_t</span> nmods = igraph_vector_size(&amp;modularity);</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>            output.<a class="code hl_variable" href="structscran_1_1ClusterSNNGraphMultiLevel_1_1Results.html#ad24f154bae449495590393bdb2ff59fc">modularity</a>.resize(nmods);</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; nmods; ++i) {</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>                output.<a class="code hl_variable" href="structscran_1_1ClusterSNNGraphMultiLevel_1_1Results.html#ad24f154bae449495590393bdb2ff59fc">modularity</a>[i] = VECTOR(modularity)[i];</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>            }</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span> </div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>            <span class="keywordtype">size_t</span> ncells = igraph_vcount(&amp;graph_info.<a class="code hl_variable" href="structscran_1_1ClusterSNNGraph_1_1Graph.html#a705ba30639aae97157d20e468294efe2">graph</a>);</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>            <span class="keywordtype">size_t</span> nlevels = igraph_matrix_nrow(&amp;memberships);</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>            output.<a class="code hl_variable" href="structscran_1_1ClusterSNNGraphMultiLevel_1_1Results.html#a27434f77a03c488270b68c08e5105e80">membership</a>.resize(nlevels);</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>            </div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; nlevels; ++i) {</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>                <span class="keyword">auto</span>&amp; current = output.<a class="code hl_variable" href="structscran_1_1ClusterSNNGraphMultiLevel_1_1Results.html#a27434f77a03c488270b68c08e5105e80">membership</a>[i];</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>                current.resize(ncells);</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; ncells; ++j) {</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>                    current[j] = MATRIX(memberships, i, j);</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>                }</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>            }</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>        }</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span> </div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>        igraph_vector_destroy(&amp;modularity);</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>        igraph_vector_destroy(&amp;membership);</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>        igraph_matrix_destroy(&amp;memberships);</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span> </div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>        <span class="keywordflow">return</span> output;</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>    }</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>};</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span> </div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno"><a class="line" href="classscran_1_1ClusterSNNGraphWalktrap.html">  344</a></span><span class="keyword">class </span><a class="code hl_class" href="classscran_1_1ClusterSNNGraphWalktrap.html">ClusterSNNGraphWalktrap</a> : <span class="keyword">public</span> <a class="code hl_class" href="classscran_1_1ClusterSNNGraph.html">ClusterSNNGraph</a> {</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno"><a class="line" href="structscran_1_1ClusterSNNGraphWalktrap_1_1Defaults.html">  349</a></span>    <span class="keyword">struct </span><a class="code hl_struct" href="structscran_1_1ClusterSNNGraphWalktrap_1_1Defaults.html">Defaults</a> {</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno"><a class="line" href="structscran_1_1ClusterSNNGraphWalktrap_1_1Defaults.html#aefa5e58e12dcef4517fec00389e99a7a">  354</a></span>        <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="structscran_1_1ClusterSNNGraphWalktrap_1_1Defaults.html#aefa5e58e12dcef4517fec00389e99a7a">steps</a> = 4;</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span> </div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno"><a class="line" href="structscran_1_1ClusterSNNGraphWalktrap_1_1Defaults.html#a87c5c1dab09f0a36f14900fd5ad5ddf9">  359</a></span>        <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="structscran_1_1ClusterSNNGraphWalktrap_1_1Defaults.html#a87c5c1dab09f0a36f14900fd5ad5ddf9">seed</a> = 42;</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>    };</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span> </div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span><span class="keyword">private</span>:</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>    <span class="keywordtype">int</span> steps = <a class="code hl_variable" href="structscran_1_1ClusterSNNGraphWalktrap_1_1Defaults.html#aefa5e58e12dcef4517fec00389e99a7a">Defaults::steps</a>;</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>    <span class="keywordtype">int</span> seed = <a class="code hl_variable" href="structscran_1_1ClusterSNNGraphWalktrap_1_1Defaults.html#a87c5c1dab09f0a36f14900fd5ad5ddf9">Defaults::seed</a>;</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span> </div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno"><a class="line" href="classscran_1_1ClusterSNNGraphWalktrap.html#ac8f7d587efdafe46c79502bc7add1f16">  372</a></span>    <a class="code hl_class" href="classscran_1_1ClusterSNNGraphWalktrap.html">ClusterSNNGraphWalktrap</a>&amp; <a class="code hl_function" href="classscran_1_1ClusterSNNGraphWalktrap.html#ac8f7d587efdafe46c79502bc7add1f16">set_neighbors</a>(<span class="keywordtype">int</span> k = <a class="code hl_variable" href="structscran_1_1BuildSNNGraph_1_1Defaults.html#a6a376b256377055e23a96c3d9eb96365">BuildSNNGraph::Defaults::neighbors</a>) {</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>        builder.<a class="code hl_function" href="classscran_1_1BuildSNNGraph.html#a22b16cc067f034eecc097b79b903a017">set_neighbors</a>(k);</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>    }</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span> </div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno"><a class="line" href="classscran_1_1ClusterSNNGraphWalktrap.html#aeb77a7925c9064bd0f7db5b3f03d3dab">  382</a></span>    <a class="code hl_class" href="classscran_1_1ClusterSNNGraphWalktrap.html">ClusterSNNGraphWalktrap</a>&amp; <a class="code hl_function" href="classscran_1_1ClusterSNNGraphWalktrap.html#aeb77a7925c9064bd0f7db5b3f03d3dab">set_approximate</a>(<span class="keywordtype">bool</span> a = <a class="code hl_variable" href="structscran_1_1BuildSNNGraph_1_1Defaults.html#af6d0a1c84cd739442a6767171e0202e0">BuildSNNGraph::Defaults::approximate</a>) {</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>        builder.<a class="code hl_function" href="classscran_1_1BuildSNNGraph.html#ac5085b513afa0e47617833e7279c61cb">set_approximate</a>(a);</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>    }</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span> </div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno"><a class="line" href="classscran_1_1ClusterSNNGraphWalktrap.html#a0441f23a53b117e1b3f874055e238b20">  392</a></span>    <a class="code hl_class" href="classscran_1_1ClusterSNNGraphWalktrap.html">ClusterSNNGraphWalktrap</a>&amp; <a class="code hl_function" href="classscran_1_1ClusterSNNGraphWalktrap.html#a0441f23a53b117e1b3f874055e238b20">set_weighting_scheme</a>(<a class="code hl_enumeration" href="classscran_1_1BuildSNNGraph.html#ae7e2167f6c3cf02432a3cdc6e4583e2a">BuildSNNGraph::Scheme</a> s = <a class="code hl_variable" href="structscran_1_1BuildSNNGraph_1_1Defaults.html#a258288cda0e643719d53a834424b56a6">BuildSNNGraph::Defaults::weighting_scheme</a>) {</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>        builder.<a class="code hl_function" href="classscran_1_1BuildSNNGraph.html#a9b2863dda326ce82c1fba43b7660e05a">set_weighting_scheme</a>(s);</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>    }</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span> </div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno"><a class="line" href="classscran_1_1ClusterSNNGraphWalktrap.html#afb44998eb606e936bc5cfe289f269961">  402</a></span>    <a class="code hl_class" href="classscran_1_1ClusterSNNGraphWalktrap.html">ClusterSNNGraphWalktrap</a>&amp; <a class="code hl_function" href="classscran_1_1ClusterSNNGraphWalktrap.html#afb44998eb606e936bc5cfe289f269961">set_seed</a>(<span class="keywordtype">int</span> s = <a class="code hl_variable" href="structscran_1_1ClusterSNNGraphWalktrap_1_1Defaults.html#a87c5c1dab09f0a36f14900fd5ad5ddf9">Defaults::seed</a>) {</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>        seed = s;</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>    }</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span> </div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno"><a class="line" href="classscran_1_1ClusterSNNGraphWalktrap.html#a726f2e2d6e3ad4d7bde13413260bedad">  412</a></span>    <a class="code hl_class" href="classscran_1_1ClusterSNNGraphWalktrap.html">ClusterSNNGraphWalktrap</a>&amp; <a class="code hl_function" href="classscran_1_1ClusterSNNGraphWalktrap.html#a726f2e2d6e3ad4d7bde13413260bedad">set_resolution</a>(<span class="keywordtype">int</span> s = <a class="code hl_variable" href="structscran_1_1ClusterSNNGraphWalktrap_1_1Defaults.html#aefa5e58e12dcef4517fec00389e99a7a">Defaults::steps</a>) {</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>        steps = s;</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>    }</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span> </div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno"><a class="line" href="structscran_1_1ClusterSNNGraphWalktrap_1_1Results.html">  421</a></span>    <span class="keyword">struct </span><a class="code hl_struct" href="structscran_1_1ClusterSNNGraphWalktrap_1_1Results.html">Results</a> {</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno"><a class="line" href="structscran_1_1ClusterSNNGraphWalktrap_1_1Results.html#acbde64cf906a6bacbf705e1c1bb7ffc4">  426</a></span>        <span class="keywordtype">int</span> <a class="code hl_variable" href="structscran_1_1ClusterSNNGraphWalktrap_1_1Results.html#acbde64cf906a6bacbf705e1c1bb7ffc4">status</a>;</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>        </div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno"><a class="line" href="structscran_1_1ClusterSNNGraphWalktrap_1_1Results.html#aa14b1d5ff2045c1513039697e5320d0f">  431</a></span>        std::vector&lt;int&gt; <a class="code hl_variable" href="structscran_1_1ClusterSNNGraphWalktrap_1_1Results.html#aa14b1d5ff2045c1513039697e5320d0f">membership</a>;</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span> </div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno"><a class="line" href="structscran_1_1ClusterSNNGraphWalktrap_1_1Results.html#aa6ef7c62f9f348d3e26592956c467e50">  437</a></span>        std::vector&lt;std::pair&lt;int, int&gt; &gt; <a class="code hl_variable" href="structscran_1_1ClusterSNNGraphWalktrap_1_1Results.html#aa6ef7c62f9f348d3e26592956c467e50">merges</a>;</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span> </div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno"><a class="line" href="structscran_1_1ClusterSNNGraphWalktrap_1_1Results.html#a54659717e5be3972357d5fd4680894d9">  443</a></span>        std::vector&lt;double&gt; <a class="code hl_variable" href="structscran_1_1ClusterSNNGraphWalktrap_1_1Results.html#a54659717e5be3972357d5fd4680894d9">modularity</a>;</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>    };</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span> </div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno"><a class="line" href="classscran_1_1ClusterSNNGraphWalktrap.html#a3b1afacb2e82afac65a279026baaec42">  457</a></span>    <a class="code hl_struct" href="structscran_1_1ClusterSNNGraphWalktrap_1_1Results.html">Results</a> <a class="code hl_function" href="classscran_1_1ClusterSNNGraphWalktrap.html#a3b1afacb2e82afac65a279026baaec42">run</a>(<span class="keywordtype">size_t</span> ndims, <span class="keywordtype">size_t</span> ncells, <span class="keyword">const</span> <span class="keywordtype">double</span>* mat) {</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>        <span class="keyword">auto</span> graph_info = <a class="code hl_function" href="classscran_1_1ClusterSNNGraph.html#a613d3b3cd5c6ab31848f8c0e2084ca89">build</a>(ndims, ncells, mat);</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>        <span class="keyword">auto</span> output = <a class="code hl_function" href="classscran_1_1ClusterSNNGraphWalktrap.html#a3b1afacb2e82afac65a279026baaec42">run</a>(graph_info);</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>        graph_info.destroy();</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>        <span class="keywordflow">return</span> output;</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>    }</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span> </div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>    <span class="keyword">template</span>&lt;<span class="keyword">class</span> Algorithm&gt;</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno"><a class="line" href="classscran_1_1ClusterSNNGraphWalktrap.html#a23049836aca344ba1402b0ee17019056">  474</a></span>    <a class="code hl_struct" href="structscran_1_1ClusterSNNGraphWalktrap_1_1Results.html">Results</a> <a class="code hl_function" href="classscran_1_1ClusterSNNGraphWalktrap.html#a23049836aca344ba1402b0ee17019056">run</a>(<span class="keyword">const</span> Algorithm* search) {</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>        <span class="keyword">auto</span> graph_info = <a class="code hl_function" href="classscran_1_1ClusterSNNGraph.html#a613d3b3cd5c6ab31848f8c0e2084ca89">build</a>(search);</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>        <span class="keyword">auto</span> output = <a class="code hl_function" href="classscran_1_1ClusterSNNGraphWalktrap.html#a3b1afacb2e82afac65a279026baaec42">run</a>(graph_info);</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>        graph_info.destroy();</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>        <span class="keywordflow">return</span> output;</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>    }</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span> </div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno"><a class="line" href="classscran_1_1ClusterSNNGraphWalktrap.html#a20b6a96221e572d007548cda76189b27">  489</a></span>    <a class="code hl_struct" href="structscran_1_1ClusterSNNGraphWalktrap_1_1Results.html">Results</a> <a class="code hl_function" href="classscran_1_1ClusterSNNGraphWalktrap.html#a20b6a96221e572d007548cda76189b27">run</a>(<span class="keywordtype">size_t</span> ncells, <span class="keyword">const</span> std::deque&lt;BuildSNNGraph::WeightedEdge&gt;&amp; store) {</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>        <span class="keyword">auto</span> graph_info = <a class="code hl_function" href="classscran_1_1ClusterSNNGraph.html#a613d3b3cd5c6ab31848f8c0e2084ca89">build</a>(ncells, store);</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>        <span class="keyword">auto</span> output = <a class="code hl_function" href="classscran_1_1ClusterSNNGraphWalktrap.html#a3b1afacb2e82afac65a279026baaec42">run</a>(graph_info);</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>        graph_info.destroy();</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>        <span class="keywordflow">return</span> output;</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>    }</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span> </div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno"><a class="line" href="classscran_1_1ClusterSNNGraphWalktrap.html#a57ccd00f50fa4129424d384f6650f176">  503</a></span>    <a class="code hl_struct" href="structscran_1_1ClusterSNNGraphWalktrap_1_1Results.html">Results</a> <a class="code hl_function" href="classscran_1_1ClusterSNNGraphWalktrap.html#a57ccd00f50fa4129424d384f6650f176">run</a>(<span class="keyword">const</span> <a class="code hl_struct" href="structscran_1_1ClusterSNNGraph_1_1Graph.html">Graph</a>&amp; graph_info) {</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>        igraph_matrix_t merges;</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>        igraph_vector_t modularity;</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>        igraph_vector_t membership;</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span> </div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>        igraph_vector_init(&amp;modularity, 0);</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>        igraph_vector_init(&amp;membership, 0);</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>        igraph_matrix_init(&amp;merges, 0, 0);</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span> </div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>        <span class="comment">// I just can&#39;t be bothered to do anything fancier here, so this is what we&#39;ve got.</span></div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>        igraph_rng_seed(igraph_rng_default(), seed);</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span> </div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span><span class="preprocessor">#ifdef SCRAN_LOGGER</span></div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>        SCRAN_LOGGER(<span class="stringliteral">&quot;scran::ClusterSNNGraph&quot;</span>, <span class="stringliteral">&quot;Performing walktrap community detection&quot;</span>);</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>        <a class="code hl_struct" href="structscran_1_1ClusterSNNGraphWalktrap_1_1Results.html">Results</a> output;</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>        output.<a class="code hl_variable" href="structscran_1_1ClusterSNNGraphWalktrap_1_1Results.html#acbde64cf906a6bacbf705e1c1bb7ffc4">status</a> = igraph_community_walktrap(&amp;graph_info.<a class="code hl_variable" href="structscran_1_1ClusterSNNGraph_1_1Graph.html#a705ba30639aae97157d20e468294efe2">graph</a>, &amp;graph_info.<a class="code hl_variable" href="structscran_1_1ClusterSNNGraph_1_1Graph.html#a1c0c132d946cf3883956168bea6f30f2">weights</a>, steps, &amp;merges, &amp;modularity, &amp;membership);</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span> </div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>        <span class="keywordflow">if</span> (!output.<a class="code hl_variable" href="structscran_1_1ClusterSNNGraphWalktrap_1_1Results.html#acbde64cf906a6bacbf705e1c1bb7ffc4">status</a>) {</div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>            <span class="keywordtype">size_t</span> nmods = igraph_vector_size(&amp;modularity);</div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>            output.<a class="code hl_variable" href="structscran_1_1ClusterSNNGraphWalktrap_1_1Results.html#a54659717e5be3972357d5fd4680894d9">modularity</a>.resize(nmods);</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; nmods; ++i) {</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>                output.<a class="code hl_variable" href="structscran_1_1ClusterSNNGraphWalktrap_1_1Results.html#a54659717e5be3972357d5fd4680894d9">modularity</a>[i] = VECTOR(modularity)[i];</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>            }</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span> </div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>            <span class="keywordtype">size_t</span> nmerges = igraph_matrix_nrow(&amp;merges);</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>            output.<a class="code hl_variable" href="structscran_1_1ClusterSNNGraphWalktrap_1_1Results.html#aa6ef7c62f9f348d3e26592956c467e50">merges</a>.resize(nmerges);</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; nmerges; ++i) {</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>                output.<a class="code hl_variable" href="structscran_1_1ClusterSNNGraphWalktrap_1_1Results.html#aa6ef7c62f9f348d3e26592956c467e50">merges</a>[i].first = MATRIX(merges, i, 0);</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>                output.<a class="code hl_variable" href="structscran_1_1ClusterSNNGraphWalktrap_1_1Results.html#aa6ef7c62f9f348d3e26592956c467e50">merges</a>[i].second = MATRIX(merges, i, 1);</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>            }</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span> </div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>            <span class="keywordtype">size_t</span> ncells = igraph_vcount(&amp;graph_info.<a class="code hl_variable" href="structscran_1_1ClusterSNNGraph_1_1Graph.html#a705ba30639aae97157d20e468294efe2">graph</a>);</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>            output.<a class="code hl_variable" href="structscran_1_1ClusterSNNGraphWalktrap_1_1Results.html#aa14b1d5ff2045c1513039697e5320d0f">membership</a>.resize(ncells);</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; ncells; ++i) {</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>                output.<a class="code hl_variable" href="structscran_1_1ClusterSNNGraphWalktrap_1_1Results.html#aa14b1d5ff2045c1513039697e5320d0f">membership</a>[i] = VECTOR(membership)[i];</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>            }</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>        }</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span> </div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>        igraph_vector_destroy(&amp;modularity);</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>        igraph_vector_destroy(&amp;membership);</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>        igraph_matrix_destroy(&amp;merges);</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span> </div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>        <span class="keywordflow">return</span> output;</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>    }</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>};</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span> </div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno"><a class="line" href="classscran_1_1ClusterSNNGraphLeiden.html">  556</a></span><span class="keyword">class </span><a class="code hl_class" href="classscran_1_1ClusterSNNGraphLeiden.html">ClusterSNNGraphLeiden</a> : <span class="keyword">public</span> <a class="code hl_class" href="classscran_1_1ClusterSNNGraph.html">ClusterSNNGraph</a> {</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno"><a class="line" href="structscran_1_1ClusterSNNGraphLeiden_1_1Defaults.html">  561</a></span>    <span class="keyword">struct </span><a class="code hl_struct" href="structscran_1_1ClusterSNNGraphLeiden_1_1Defaults.html">Defaults</a> {</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno"><a class="line" href="structscran_1_1ClusterSNNGraphLeiden_1_1Defaults.html#a235d41d736b35e40d0162d3eff856361">  566</a></span>        <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="structscran_1_1ClusterSNNGraphLeiden_1_1Defaults.html#a235d41d736b35e40d0162d3eff856361">resolution</a> = 0.05;</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span> </div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno"><a class="line" href="structscran_1_1ClusterSNNGraphLeiden_1_1Defaults.html#a90a2dca1eed5d37c6b12da18e9f0d9e8">  572</a></span>        <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="structscran_1_1ClusterSNNGraphLeiden_1_1Defaults.html#a90a2dca1eed5d37c6b12da18e9f0d9e8">beta</a> = 0.01;</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span> </div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno"><a class="line" href="structscran_1_1ClusterSNNGraphLeiden_1_1Defaults.html#adec09fa56454245d43af1561d1d4a8ea">  578</a></span>        <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="structscran_1_1ClusterSNNGraphLeiden_1_1Defaults.html#adec09fa56454245d43af1561d1d4a8ea">iterations</a> = 10;</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span> </div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno"><a class="line" href="structscran_1_1ClusterSNNGraphLeiden_1_1Defaults.html#ac1bf98a6de928de8b786643942768deb">  583</a></span>        <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">bool</span> <a class="code hl_variable" href="structscran_1_1ClusterSNNGraphLeiden_1_1Defaults.html#ac1bf98a6de928de8b786643942768deb">modularity</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span> </div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno"><a class="line" href="structscran_1_1ClusterSNNGraphLeiden_1_1Defaults.html#a9f83e589fd30c36c30c5ee5a4e9ccf8e">  588</a></span>        <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="structscran_1_1ClusterSNNGraphLeiden_1_1Defaults.html#a9f83e589fd30c36c30c5ee5a4e9ccf8e">seed</a> = 42;</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>    };</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span> </div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span><span class="keyword">private</span>:</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>    <span class="keywordtype">double</span> resolution = <a class="code hl_variable" href="structscran_1_1ClusterSNNGraphLeiden_1_1Defaults.html#a235d41d736b35e40d0162d3eff856361">Defaults::resolution</a>;</div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>    <span class="keywordtype">double</span> beta = <a class="code hl_variable" href="structscran_1_1ClusterSNNGraphLeiden_1_1Defaults.html#a90a2dca1eed5d37c6b12da18e9f0d9e8">Defaults::beta</a>;</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>    <span class="keywordtype">int</span> iterations = <a class="code hl_variable" href="structscran_1_1ClusterSNNGraphLeiden_1_1Defaults.html#adec09fa56454245d43af1561d1d4a8ea">Defaults::iterations</a>;</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>    <span class="keywordtype">bool</span> modularity = <a class="code hl_variable" href="structscran_1_1ClusterSNNGraphLeiden_1_1Defaults.html#ac1bf98a6de928de8b786643942768deb">Defaults::modularity</a>;</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>    <span class="keywordtype">int</span> seed = <a class="code hl_variable" href="structscran_1_1ClusterSNNGraphLeiden_1_1Defaults.html#a9f83e589fd30c36c30c5ee5a4e9ccf8e">Defaults::seed</a>;</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span> </div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno"><a class="line" href="classscran_1_1ClusterSNNGraphLeiden.html#a5b7b6aa9238db09d84b1f4178a3f86b6">  604</a></span>    <a class="code hl_class" href="classscran_1_1ClusterSNNGraphLeiden.html">ClusterSNNGraphLeiden</a>&amp; <a class="code hl_function" href="classscran_1_1ClusterSNNGraphLeiden.html#a5b7b6aa9238db09d84b1f4178a3f86b6">set_neighbors</a>(<span class="keywordtype">int</span> k = <a class="code hl_variable" href="structscran_1_1BuildSNNGraph_1_1Defaults.html#a6a376b256377055e23a96c3d9eb96365">BuildSNNGraph::Defaults::neighbors</a>) {</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>        builder.<a class="code hl_function" href="classscran_1_1BuildSNNGraph.html#a22b16cc067f034eecc097b79b903a017">set_neighbors</a>(k);</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>    }</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span> </div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno"><a class="line" href="classscran_1_1ClusterSNNGraphLeiden.html#aa24aed9c5dcdddc28fd72b20e895b0b8">  614</a></span>    <a class="code hl_class" href="classscran_1_1ClusterSNNGraphLeiden.html">ClusterSNNGraphLeiden</a>&amp; <a class="code hl_function" href="classscran_1_1ClusterSNNGraphLeiden.html#aa24aed9c5dcdddc28fd72b20e895b0b8">set_approximate</a>(<span class="keywordtype">bool</span> a = <a class="code hl_variable" href="structscran_1_1BuildSNNGraph_1_1Defaults.html#af6d0a1c84cd739442a6767171e0202e0">BuildSNNGraph::Defaults::approximate</a>) {</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>        builder.<a class="code hl_function" href="classscran_1_1BuildSNNGraph.html#ac5085b513afa0e47617833e7279c61cb">set_approximate</a>(a);</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>    }</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span> </div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno"><a class="line" href="classscran_1_1ClusterSNNGraphLeiden.html#afef13b0d593baf1e13c93c4a0c92f7ba">  624</a></span>    <a class="code hl_class" href="classscran_1_1ClusterSNNGraphLeiden.html">ClusterSNNGraphLeiden</a>&amp; <a class="code hl_function" href="classscran_1_1ClusterSNNGraphLeiden.html#afef13b0d593baf1e13c93c4a0c92f7ba">set_weighting_scheme</a>(<a class="code hl_enumeration" href="classscran_1_1BuildSNNGraph.html#ae7e2167f6c3cf02432a3cdc6e4583e2a">BuildSNNGraph::Scheme</a> s = <a class="code hl_variable" href="structscran_1_1BuildSNNGraph_1_1Defaults.html#a258288cda0e643719d53a834424b56a6">BuildSNNGraph::Defaults::weighting_scheme</a>) {</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>        builder.<a class="code hl_function" href="classscran_1_1BuildSNNGraph.html#a9b2863dda326ce82c1fba43b7660e05a">set_weighting_scheme</a>(s);</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>    }</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span> </div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno"><a class="line" href="classscran_1_1ClusterSNNGraphLeiden.html#a63d442391967db7e1be9fbdbdfe5b735">  634</a></span>    <a class="code hl_class" href="classscran_1_1ClusterSNNGraphLeiden.html">ClusterSNNGraphLeiden</a>&amp; <a class="code hl_function" href="classscran_1_1ClusterSNNGraphLeiden.html#a63d442391967db7e1be9fbdbdfe5b735">set_seed</a>(<span class="keywordtype">int</span> s = <a class="code hl_variable" href="structscran_1_1ClusterSNNGraphLeiden_1_1Defaults.html#a9f83e589fd30c36c30c5ee5a4e9ccf8e">Defaults::seed</a>) {</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>        seed = s;</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>    }</div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span> </div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno"><a class="line" href="classscran_1_1ClusterSNNGraphLeiden.html#a620418116cb13d7d020f0e5eb1f8c011">  645</a></span>    <a class="code hl_class" href="classscran_1_1ClusterSNNGraphLeiden.html">ClusterSNNGraphLeiden</a>&amp; <a class="code hl_function" href="classscran_1_1ClusterSNNGraphLeiden.html#a620418116cb13d7d020f0e5eb1f8c011">set_resolution</a>(<span class="keywordtype">double</span> r = <a class="code hl_variable" href="structscran_1_1ClusterSNNGraphLeiden_1_1Defaults.html#a235d41d736b35e40d0162d3eff856361">Defaults::resolution</a>) {</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>        resolution = r;</div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>    }</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span> </div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno"><a class="line" href="classscran_1_1ClusterSNNGraphLeiden.html#adc9b19074330bf011296746130ae27a5">  655</a></span>    <a class="code hl_class" href="classscran_1_1ClusterSNNGraphLeiden.html">ClusterSNNGraphLeiden</a>&amp; <a class="code hl_function" href="classscran_1_1ClusterSNNGraphLeiden.html#adc9b19074330bf011296746130ae27a5">set_beta</a>(<span class="keywordtype">double</span> b = <a class="code hl_variable" href="structscran_1_1ClusterSNNGraphLeiden_1_1Defaults.html#a90a2dca1eed5d37c6b12da18e9f0d9e8">Defaults::beta</a>) {</div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>        beta = b;</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>    }</div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span> </div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno"><a class="line" href="classscran_1_1ClusterSNNGraphLeiden.html#a4dddb1b05e1890b9c90406743f7479e5">  666</a></span>    <a class="code hl_class" href="classscran_1_1ClusterSNNGraphLeiden.html">ClusterSNNGraphLeiden</a>&amp; <a class="code hl_function" href="classscran_1_1ClusterSNNGraphLeiden.html#a4dddb1b05e1890b9c90406743f7479e5">set_iterations</a>(<span class="keywordtype">double</span> i = <a class="code hl_variable" href="structscran_1_1ClusterSNNGraphLeiden_1_1Defaults.html#adec09fa56454245d43af1561d1d4a8ea">Defaults::iterations</a>) {</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>        iterations = i;</div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>    }</div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span> </div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno"><a class="line" href="classscran_1_1ClusterSNNGraphLeiden.html#a116eb8563e21881387bc57a8ef3e5629">  679</a></span>    <a class="code hl_class" href="classscran_1_1ClusterSNNGraphLeiden.html">ClusterSNNGraphLeiden</a>&amp; <a class="code hl_function" href="classscran_1_1ClusterSNNGraphLeiden.html#a116eb8563e21881387bc57a8ef3e5629">set_modularity</a>(<span class="keywordtype">double</span> m = <a class="code hl_variable" href="structscran_1_1ClusterSNNGraphLeiden_1_1Defaults.html#ac1bf98a6de928de8b786643942768deb">Defaults::modularity</a>) {</div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>        modularity = m;</div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>    }</div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span> </div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno"><a class="line" href="structscran_1_1ClusterSNNGraphLeiden_1_1Results.html">  688</a></span>    <span class="keyword">struct </span><a class="code hl_struct" href="structscran_1_1ClusterSNNGraphLeiden_1_1Results.html">Results</a> {</div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno"><a class="line" href="structscran_1_1ClusterSNNGraphLeiden_1_1Results.html#a790d4642f2b5001595c569dcf0bf7ec6">  693</a></span>        <span class="keywordtype">int</span> <a class="code hl_variable" href="structscran_1_1ClusterSNNGraphLeiden_1_1Results.html#a790d4642f2b5001595c569dcf0bf7ec6">status</a>;</div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>        </div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno"><a class="line" href="structscran_1_1ClusterSNNGraphLeiden_1_1Results.html#a2a59465810969c36e6a084f5cac31675">  698</a></span>        std::vector&lt;int&gt; <a class="code hl_variable" href="structscran_1_1ClusterSNNGraphLeiden_1_1Results.html#a2a59465810969c36e6a084f5cac31675">membership</a>;</div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span> </div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno"><a class="line" href="structscran_1_1ClusterSNNGraphLeiden_1_1Results.html#a997a0d553c10721ea74ffcafc5dfb742">  703</a></span>        <span class="keywordtype">double</span> <a class="code hl_variable" href="structscran_1_1ClusterSNNGraphLeiden_1_1Results.html#a997a0d553c10721ea74ffcafc5dfb742">quality</a>;</div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>    };</div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span> </div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno"><a class="line" href="classscran_1_1ClusterSNNGraphLeiden.html#a7c59b39b7d0621f42621298a365d0398">  717</a></span>    <a class="code hl_struct" href="structscran_1_1ClusterSNNGraphLeiden_1_1Results.html">Results</a> <a class="code hl_function" href="classscran_1_1ClusterSNNGraphLeiden.html#a7c59b39b7d0621f42621298a365d0398">run</a>(<span class="keywordtype">size_t</span> ndims, <span class="keywordtype">size_t</span> ncells, <span class="keyword">const</span> <span class="keywordtype">double</span>* mat) {</div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>        <span class="keyword">auto</span> graph_info = <a class="code hl_function" href="classscran_1_1ClusterSNNGraph.html#a613d3b3cd5c6ab31848f8c0e2084ca89">build</a>(ndims, ncells, mat);</div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>        <span class="keyword">auto</span> output = <a class="code hl_function" href="classscran_1_1ClusterSNNGraphLeiden.html#a7c59b39b7d0621f42621298a365d0398">run</a>(graph_info);</div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>        graph_info.destroy();</div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>        <span class="keywordflow">return</span> output;</div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>    }</div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span> </div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span>    <span class="keyword">template</span>&lt;<span class="keyword">class</span> Algorithm&gt;</div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno"><a class="line" href="classscran_1_1ClusterSNNGraphLeiden.html#a7016bec22e6b0b20933a7c799bff4baf">  734</a></span>    <a class="code hl_struct" href="structscran_1_1ClusterSNNGraphLeiden_1_1Results.html">Results</a> <a class="code hl_function" href="classscran_1_1ClusterSNNGraphLeiden.html#a7016bec22e6b0b20933a7c799bff4baf">run</a>(<span class="keyword">const</span> Algorithm* search) {</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>        <span class="keyword">auto</span> graph_info = <a class="code hl_function" href="classscran_1_1ClusterSNNGraph.html#a613d3b3cd5c6ab31848f8c0e2084ca89">build</a>(search);</div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>        <span class="keyword">auto</span> output = <a class="code hl_function" href="classscran_1_1ClusterSNNGraphLeiden.html#a7c59b39b7d0621f42621298a365d0398">run</a>(graph_info);</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>        graph_info.destroy();</div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span>        <span class="keywordflow">return</span> output;</div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span>    }</div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span> </div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno"><a class="line" href="classscran_1_1ClusterSNNGraphLeiden.html#aa89a8c2dbd791d3d6037daf12c04b704">  749</a></span>    <a class="code hl_struct" href="structscran_1_1ClusterSNNGraphLeiden_1_1Results.html">Results</a> <a class="code hl_function" href="classscran_1_1ClusterSNNGraphLeiden.html#aa89a8c2dbd791d3d6037daf12c04b704">run</a>(<span class="keywordtype">size_t</span> ncells, <span class="keyword">const</span> std::deque&lt;BuildSNNGraph::WeightedEdge&gt;&amp; store) {</div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span>        <span class="keyword">auto</span> graph_info = <a class="code hl_function" href="classscran_1_1ClusterSNNGraph.html#a613d3b3cd5c6ab31848f8c0e2084ca89">build</a>(ncells, store);</div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span>        <span class="keyword">auto</span> output = <a class="code hl_function" href="classscran_1_1ClusterSNNGraphLeiden.html#a7c59b39b7d0621f42621298a365d0398">run</a>(graph_info);</div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>        graph_info.destroy();</div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span>        <span class="keywordflow">return</span> output;</div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>    }</div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span> </div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno"><a class="line" href="classscran_1_1ClusterSNNGraphLeiden.html#a7ad06c728e4e26031a205dc51961f4fd">  763</a></span>    <a class="code hl_struct" href="structscran_1_1ClusterSNNGraphLeiden_1_1Results.html">Results</a> <a class="code hl_function" href="classscran_1_1ClusterSNNGraphLeiden.html#a7ad06c728e4e26031a205dc51961f4fd">run</a>(<span class="keyword">const</span> <a class="code hl_struct" href="structscran_1_1ClusterSNNGraph_1_1Graph.html">Graph</a>&amp; graph_info) {</div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>        igraph_vector_t membership;</div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>        igraph_integer_t nb_clusters;</div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span>        igraph_real_t quality;</div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span> </div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span>        igraph_vector_init(&amp;membership, 0);</div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span> </div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span>        <span class="comment">// I just can&#39;t be bothered to do anything fancier here, so this is what we&#39;ve got.</span></div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span>        igraph_rng_seed(igraph_rng_default(), seed);</div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span>        <a class="code hl_struct" href="structscran_1_1ClusterSNNGraphLeiden_1_1Results.html">Results</a> output;</div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span> </div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>        <span class="keywordflow">if</span> (!modularity) {</div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; iterations; ++i) {</div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span>                output.<a class="code hl_variable" href="structscran_1_1ClusterSNNGraphLeiden_1_1Results.html#a790d4642f2b5001595c569dcf0bf7ec6">status</a> = igraph_community_leiden(&amp;graph_info.<a class="code hl_variable" href="structscran_1_1ClusterSNNGraph_1_1Graph.html#a705ba30639aae97157d20e468294efe2">graph</a>, &amp;graph_info.<a class="code hl_variable" href="structscran_1_1ClusterSNNGraph_1_1Graph.html#a1c0c132d946cf3883956168bea6f30f2">weights</a>, NULL, resolution, beta, 0, &amp;membership, &amp;nb_clusters, &amp;quality);</div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span>                <span class="keywordflow">if</span> (output.<a class="code hl_variable" href="structscran_1_1ClusterSNNGraphLeiden_1_1Results.html#a790d4642f2b5001595c569dcf0bf7ec6">status</a>) {</div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>                }</div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span>            }</div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span>            <span class="comment">// Based on https://igraph.org/c/doc/igraph-Community.html#igraph_community_leiden.</span></div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span>            igraph_vector_t degree;</div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span>            igraph_vector_init(&amp;degree, igraph_vcount(&amp;graph_info.<a class="code hl_variable" href="structscran_1_1ClusterSNNGraph_1_1Graph.html#a705ba30639aae97157d20e468294efe2">graph</a>));</div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span>            igraph_degree(&amp;graph_info.<a class="code hl_variable" href="structscran_1_1ClusterSNNGraph_1_1Graph.html#a705ba30639aae97157d20e468294efe2">graph</a>, &amp;degree, igraph_vss_all(), IGRAPH_ALL, 1);</div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span> </div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span>            <span class="comment">// We divide the resolution by 2 * m rather than fixing resolution</span></div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span>            <span class="comment">// = 1 as in the documented example. This ensures that we can</span></div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>            <span class="comment">// still respond to changes in resolution, though users will probably</span></div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span>            <span class="comment">// need to bump up the resolution to a larger value to compensate.</span></div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>            <span class="keywordtype">double</span> mod_resolution = resolution / (2 * igraph_ecount(&amp;graph_info.<a class="code hl_variable" href="structscran_1_1ClusterSNNGraph_1_1Graph.html#a705ba30639aae97157d20e468294efe2">graph</a>));</div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>            </div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; iterations; ++i) {</div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span>                output.<a class="code hl_variable" href="structscran_1_1ClusterSNNGraphLeiden_1_1Results.html#a790d4642f2b5001595c569dcf0bf7ec6">status</a> = igraph_community_leiden(&amp;graph_info.<a class="code hl_variable" href="structscran_1_1ClusterSNNGraph_1_1Graph.html#a705ba30639aae97157d20e468294efe2">graph</a>, &amp;graph_info.<a class="code hl_variable" href="structscran_1_1ClusterSNNGraph_1_1Graph.html#a1c0c132d946cf3883956168bea6f30f2">weights</a>, &amp;degree, mod_resolution, beta, 0, &amp;membership, &amp;nb_clusters, &amp;quality);</div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>                <span class="keywordflow">if</span> (output.<a class="code hl_variable" href="structscran_1_1ClusterSNNGraphLeiden_1_1Results.html#a790d4642f2b5001595c569dcf0bf7ec6">status</a>) {</div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span>                }</div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span>            }</div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span> </div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span>            igraph_vector_destroy(&amp;degree);</div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span>        }</div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span> </div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span>        <span class="keywordflow">if</span> (!output.<a class="code hl_variable" href="structscran_1_1ClusterSNNGraphLeiden_1_1Results.html#a790d4642f2b5001595c569dcf0bf7ec6">status</a>) {</div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span>            <span class="keywordtype">size_t</span> ncells = igraph_vcount(&amp;graph_info.<a class="code hl_variable" href="structscran_1_1ClusterSNNGraph_1_1Graph.html#a705ba30639aae97157d20e468294efe2">graph</a>);</div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span>            output.<a class="code hl_variable" href="structscran_1_1ClusterSNNGraphLeiden_1_1Results.html#a2a59465810969c36e6a084f5cac31675">membership</a>.resize(ncells);</div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; ncells; ++i) {</div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span>                output.<a class="code hl_variable" href="structscran_1_1ClusterSNNGraphLeiden_1_1Results.html#a2a59465810969c36e6a084f5cac31675">membership</a>[i] = VECTOR(membership)[i];</div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span>            }</div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span>            output.<a class="code hl_variable" href="structscran_1_1ClusterSNNGraphLeiden_1_1Results.html#a997a0d553c10721ea74ffcafc5dfb742">quality</a> = quality;</div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span>        }</div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span> </div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span>        igraph_vector_destroy(&amp;membership);</div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span> </div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span>        <span class="keywordflow">return</span> output;</div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span>    }</div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span>};</div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span> </div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span>}</div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span> </div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span> </div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span> </div>
<div class="ttc" id="aBuildSNNGraph_8hpp_html"><div class="ttname"><a href="BuildSNNGraph_8hpp.html">BuildSNNGraph.hpp</a></div><div class="ttdoc">Build a shared nearest-neighbor graph on the cells.</div></div>
<div class="ttc" id="aclassscran_1_1BuildSNNGraph_html"><div class="ttname"><a href="classscran_1_1BuildSNNGraph.html">scran::BuildSNNGraph</a></div><div class="ttdoc">Build a shared nearest-neighbor graph with cells as nodes.</div><div class="ttdef"><b>Definition:</b> BuildSNNGraph.hpp:49</div></div>
<div class="ttc" id="aclassscran_1_1BuildSNNGraph_html_a22b16cc067f034eecc097b79b903a017"><div class="ttname"><a href="classscran_1_1BuildSNNGraph.html#a22b16cc067f034eecc097b79b903a017">scran::BuildSNNGraph::set_neighbors</a></div><div class="ttdeci">BuildSNNGraph &amp; set_neighbors(int k=Defaults::neighbors)</div><div class="ttdef"><b>Definition:</b> BuildSNNGraph.hpp:86</div></div>
<div class="ttc" id="aclassscran_1_1BuildSNNGraph_html_a6f2a0276125b2f8426afecb32cd7080e"><div class="ttname"><a href="classscran_1_1BuildSNNGraph.html#a6f2a0276125b2f8426afecb32cd7080e">scran::BuildSNNGraph::run</a></div><div class="ttdeci">std::deque&lt; WeightedEdge &gt; run(size_t ndims, size_t ncells, const double *mat) const</div><div class="ttdef"><b>Definition:</b> BuildSNNGraph.hpp:127</div></div>
<div class="ttc" id="aclassscran_1_1BuildSNNGraph_html_a9b2863dda326ce82c1fba43b7660e05a"><div class="ttname"><a href="classscran_1_1BuildSNNGraph.html#a9b2863dda326ce82c1fba43b7660e05a">scran::BuildSNNGraph::set_weighting_scheme</a></div><div class="ttdeci">BuildSNNGraph &amp; set_weighting_scheme(Scheme w=Defaults::weighting_scheme)</div><div class="ttdef"><b>Definition:</b> BuildSNNGraph.hpp:106</div></div>
<div class="ttc" id="aclassscran_1_1BuildSNNGraph_html_ac5085b513afa0e47617833e7279c61cb"><div class="ttname"><a href="classscran_1_1BuildSNNGraph.html#ac5085b513afa0e47617833e7279c61cb">scran::BuildSNNGraph::set_approximate</a></div><div class="ttdeci">BuildSNNGraph &amp; set_approximate(bool a=Defaults::approximate)</div><div class="ttdef"><b>Definition:</b> BuildSNNGraph.hpp:96</div></div>
<div class="ttc" id="aclassscran_1_1BuildSNNGraph_html_ae7e2167f6c3cf02432a3cdc6e4583e2a"><div class="ttname"><a href="classscran_1_1BuildSNNGraph.html#ae7e2167f6c3cf02432a3cdc6e4583e2a">scran::BuildSNNGraph::Scheme</a></div><div class="ttdeci">Scheme</div><div class="ttdef"><b>Definition:</b> BuildSNNGraph.hpp:54</div></div>
<div class="ttc" id="aclassscran_1_1ClusterSNNGraphLeiden_html"><div class="ttname"><a href="classscran_1_1ClusterSNNGraphLeiden.html">scran::ClusterSNNGraphLeiden</a></div><div class="ttdoc">Leiden clustering on a shared nearest-neighbor graph.</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:556</div></div>
<div class="ttc" id="aclassscran_1_1ClusterSNNGraphLeiden_html_a116eb8563e21881387bc57a8ef3e5629"><div class="ttname"><a href="classscran_1_1ClusterSNNGraphLeiden.html#a116eb8563e21881387bc57a8ef3e5629">scran::ClusterSNNGraphLeiden::set_modularity</a></div><div class="ttdeci">ClusterSNNGraphLeiden &amp; set_modularity(double m=Defaults::modularity)</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:679</div></div>
<div class="ttc" id="aclassscran_1_1ClusterSNNGraphLeiden_html_a4dddb1b05e1890b9c90406743f7479e5"><div class="ttname"><a href="classscran_1_1ClusterSNNGraphLeiden.html#a4dddb1b05e1890b9c90406743f7479e5">scran::ClusterSNNGraphLeiden::set_iterations</a></div><div class="ttdeci">ClusterSNNGraphLeiden &amp; set_iterations(double i=Defaults::iterations)</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:666</div></div>
<div class="ttc" id="aclassscran_1_1ClusterSNNGraphLeiden_html_a5b7b6aa9238db09d84b1f4178a3f86b6"><div class="ttname"><a href="classscran_1_1ClusterSNNGraphLeiden.html#a5b7b6aa9238db09d84b1f4178a3f86b6">scran::ClusterSNNGraphLeiden::set_neighbors</a></div><div class="ttdeci">ClusterSNNGraphLeiden &amp; set_neighbors(int k=BuildSNNGraph::Defaults::neighbors)</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:604</div></div>
<div class="ttc" id="aclassscran_1_1ClusterSNNGraphLeiden_html_a620418116cb13d7d020f0e5eb1f8c011"><div class="ttname"><a href="classscran_1_1ClusterSNNGraphLeiden.html#a620418116cb13d7d020f0e5eb1f8c011">scran::ClusterSNNGraphLeiden::set_resolution</a></div><div class="ttdeci">ClusterSNNGraphLeiden &amp; set_resolution(double r=Defaults::resolution)</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:645</div></div>
<div class="ttc" id="aclassscran_1_1ClusterSNNGraphLeiden_html_a63d442391967db7e1be9fbdbdfe5b735"><div class="ttname"><a href="classscran_1_1ClusterSNNGraphLeiden.html#a63d442391967db7e1be9fbdbdfe5b735">scran::ClusterSNNGraphLeiden::set_seed</a></div><div class="ttdeci">ClusterSNNGraphLeiden &amp; set_seed(int s=Defaults::seed)</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:634</div></div>
<div class="ttc" id="aclassscran_1_1ClusterSNNGraphLeiden_html_a7016bec22e6b0b20933a7c799bff4baf"><div class="ttname"><a href="classscran_1_1ClusterSNNGraphLeiden.html#a7016bec22e6b0b20933a7c799bff4baf">scran::ClusterSNNGraphLeiden::run</a></div><div class="ttdeci">Results run(const Algorithm *search)</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:734</div></div>
<div class="ttc" id="aclassscran_1_1ClusterSNNGraphLeiden_html_a7ad06c728e4e26031a205dc51961f4fd"><div class="ttname"><a href="classscran_1_1ClusterSNNGraphLeiden.html#a7ad06c728e4e26031a205dc51961f4fd">scran::ClusterSNNGraphLeiden::run</a></div><div class="ttdeci">Results run(const Graph &amp;graph_info)</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:763</div></div>
<div class="ttc" id="aclassscran_1_1ClusterSNNGraphLeiden_html_a7c59b39b7d0621f42621298a365d0398"><div class="ttname"><a href="classscran_1_1ClusterSNNGraphLeiden.html#a7c59b39b7d0621f42621298a365d0398">scran::ClusterSNNGraphLeiden::run</a></div><div class="ttdeci">Results run(size_t ndims, size_t ncells, const double *mat)</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:717</div></div>
<div class="ttc" id="aclassscran_1_1ClusterSNNGraphLeiden_html_aa24aed9c5dcdddc28fd72b20e895b0b8"><div class="ttname"><a href="classscran_1_1ClusterSNNGraphLeiden.html#aa24aed9c5dcdddc28fd72b20e895b0b8">scran::ClusterSNNGraphLeiden::set_approximate</a></div><div class="ttdeci">ClusterSNNGraphLeiden &amp; set_approximate(bool a=BuildSNNGraph::Defaults::approximate)</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:614</div></div>
<div class="ttc" id="aclassscran_1_1ClusterSNNGraphLeiden_html_aa89a8c2dbd791d3d6037daf12c04b704"><div class="ttname"><a href="classscran_1_1ClusterSNNGraphLeiden.html#aa89a8c2dbd791d3d6037daf12c04b704">scran::ClusterSNNGraphLeiden::run</a></div><div class="ttdeci">Results run(size_t ncells, const std::deque&lt; BuildSNNGraph::WeightedEdge &gt; &amp;store)</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:749</div></div>
<div class="ttc" id="aclassscran_1_1ClusterSNNGraphLeiden_html_adc9b19074330bf011296746130ae27a5"><div class="ttname"><a href="classscran_1_1ClusterSNNGraphLeiden.html#adc9b19074330bf011296746130ae27a5">scran::ClusterSNNGraphLeiden::set_beta</a></div><div class="ttdeci">ClusterSNNGraphLeiden &amp; set_beta(double b=Defaults::beta)</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:655</div></div>
<div class="ttc" id="aclassscran_1_1ClusterSNNGraphLeiden_html_afef13b0d593baf1e13c93c4a0c92f7ba"><div class="ttname"><a href="classscran_1_1ClusterSNNGraphLeiden.html#afef13b0d593baf1e13c93c4a0c92f7ba">scran::ClusterSNNGraphLeiden::set_weighting_scheme</a></div><div class="ttdeci">ClusterSNNGraphLeiden &amp; set_weighting_scheme(BuildSNNGraph::Scheme s=BuildSNNGraph::Defaults::weighting_scheme)</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:624</div></div>
<div class="ttc" id="aclassscran_1_1ClusterSNNGraphMultiLevel_html"><div class="ttname"><a href="classscran_1_1ClusterSNNGraphMultiLevel.html">scran::ClusterSNNGraphMultiLevel</a></div><div class="ttdoc">Multi-level clustering on a shared nearest-neighbor graph.</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:128</div></div>
<div class="ttc" id="aclassscran_1_1ClusterSNNGraphMultiLevel_html_a0436cbf1ed96a1f3a825dc7864eb19b1"><div class="ttname"><a href="classscran_1_1ClusterSNNGraphMultiLevel.html#a0436cbf1ed96a1f3a825dc7864eb19b1">scran::ClusterSNNGraphMultiLevel::run</a></div><div class="ttdeci">Results run(size_t ncells, const std::deque&lt; BuildSNNGraph::WeightedEdge &gt; &amp;store)</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:277</div></div>
<div class="ttc" id="aclassscran_1_1ClusterSNNGraphMultiLevel_html_a28ba7d3aefecb5756728398840f351ec"><div class="ttname"><a href="classscran_1_1ClusterSNNGraphMultiLevel.html#a28ba7d3aefecb5756728398840f351ec">scran::ClusterSNNGraphMultiLevel::run</a></div><div class="ttdeci">Results run(const Graph &amp;graph_info)</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:291</div></div>
<div class="ttc" id="aclassscran_1_1ClusterSNNGraphMultiLevel_html_a4e8e613827e91b3143fac08132433481"><div class="ttname"><a href="classscran_1_1ClusterSNNGraphMultiLevel.html#a4e8e613827e91b3143fac08132433481">scran::ClusterSNNGraphMultiLevel::set_weighting_scheme</a></div><div class="ttdeci">ClusterSNNGraphMultiLevel &amp; set_weighting_scheme(BuildSNNGraph::Scheme s=BuildSNNGraph::Defaults::weighting_scheme)</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:175</div></div>
<div class="ttc" id="aclassscran_1_1ClusterSNNGraphMultiLevel_html_a87a7d6037f87883d36b1a25b0f550fdb"><div class="ttname"><a href="classscran_1_1ClusterSNNGraphMultiLevel.html#a87a7d6037f87883d36b1a25b0f550fdb">scran::ClusterSNNGraphMultiLevel::set_approximate</a></div><div class="ttdeci">ClusterSNNGraphMultiLevel &amp; set_approximate(bool a=BuildSNNGraph::Defaults::approximate)</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:165</div></div>
<div class="ttc" id="aclassscran_1_1ClusterSNNGraphMultiLevel_html_ac419751ecdd32e0895eda89f653efcdc"><div class="ttname"><a href="classscran_1_1ClusterSNNGraphMultiLevel.html#ac419751ecdd32e0895eda89f653efcdc">scran::ClusterSNNGraphMultiLevel::run</a></div><div class="ttdeci">Results run(const Algorithm *search)</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:262</div></div>
<div class="ttc" id="aclassscran_1_1ClusterSNNGraphMultiLevel_html_ad8f5902012b6ee4a950123eaeee739e8"><div class="ttname"><a href="classscran_1_1ClusterSNNGraphMultiLevel.html#ad8f5902012b6ee4a950123eaeee739e8">scran::ClusterSNNGraphMultiLevel::set_resolution</a></div><div class="ttdeci">ClusterSNNGraphMultiLevel &amp; set_resolution(double r=Defaults::resolution)</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:196</div></div>
<div class="ttc" id="aclassscran_1_1ClusterSNNGraphMultiLevel_html_adf87b496fe1a83e05412c2b530625247"><div class="ttname"><a href="classscran_1_1ClusterSNNGraphMultiLevel.html#adf87b496fe1a83e05412c2b530625247">scran::ClusterSNNGraphMultiLevel::set_seed</a></div><div class="ttdeci">ClusterSNNGraphMultiLevel &amp; set_seed(int s=Defaults::seed)</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:185</div></div>
<div class="ttc" id="aclassscran_1_1ClusterSNNGraphMultiLevel_html_ae759e205c202313ea7f91262216b5d8e"><div class="ttname"><a href="classscran_1_1ClusterSNNGraphMultiLevel.html#ae759e205c202313ea7f91262216b5d8e">scran::ClusterSNNGraphMultiLevel::set_neighbors</a></div><div class="ttdeci">ClusterSNNGraphMultiLevel &amp; set_neighbors(int k=BuildSNNGraph::Defaults::neighbors)</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:155</div></div>
<div class="ttc" id="aclassscran_1_1ClusterSNNGraphMultiLevel_html_aee656f0e8b2adce118a2ae16375735a5"><div class="ttname"><a href="classscran_1_1ClusterSNNGraphMultiLevel.html#aee656f0e8b2adce118a2ae16375735a5">scran::ClusterSNNGraphMultiLevel::run</a></div><div class="ttdeci">Results run(size_t ndims, size_t ncells, const double *mat)</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:245</div></div>
<div class="ttc" id="aclassscran_1_1ClusterSNNGraphWalktrap_html"><div class="ttname"><a href="classscran_1_1ClusterSNNGraphWalktrap.html">scran::ClusterSNNGraphWalktrap</a></div><div class="ttdoc">Walktrap clustering on a shared nearest-neighbor graph.</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:344</div></div>
<div class="ttc" id="aclassscran_1_1ClusterSNNGraphWalktrap_html_a0441f23a53b117e1b3f874055e238b20"><div class="ttname"><a href="classscran_1_1ClusterSNNGraphWalktrap.html#a0441f23a53b117e1b3f874055e238b20">scran::ClusterSNNGraphWalktrap::set_weighting_scheme</a></div><div class="ttdeci">ClusterSNNGraphWalktrap &amp; set_weighting_scheme(BuildSNNGraph::Scheme s=BuildSNNGraph::Defaults::weighting_scheme)</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:392</div></div>
<div class="ttc" id="aclassscran_1_1ClusterSNNGraphWalktrap_html_a20b6a96221e572d007548cda76189b27"><div class="ttname"><a href="classscran_1_1ClusterSNNGraphWalktrap.html#a20b6a96221e572d007548cda76189b27">scran::ClusterSNNGraphWalktrap::run</a></div><div class="ttdeci">Results run(size_t ncells, const std::deque&lt; BuildSNNGraph::WeightedEdge &gt; &amp;store)</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:489</div></div>
<div class="ttc" id="aclassscran_1_1ClusterSNNGraphWalktrap_html_a23049836aca344ba1402b0ee17019056"><div class="ttname"><a href="classscran_1_1ClusterSNNGraphWalktrap.html#a23049836aca344ba1402b0ee17019056">scran::ClusterSNNGraphWalktrap::run</a></div><div class="ttdeci">Results run(const Algorithm *search)</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:474</div></div>
<div class="ttc" id="aclassscran_1_1ClusterSNNGraphWalktrap_html_a3b1afacb2e82afac65a279026baaec42"><div class="ttname"><a href="classscran_1_1ClusterSNNGraphWalktrap.html#a3b1afacb2e82afac65a279026baaec42">scran::ClusterSNNGraphWalktrap::run</a></div><div class="ttdeci">Results run(size_t ndims, size_t ncells, const double *mat)</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:457</div></div>
<div class="ttc" id="aclassscran_1_1ClusterSNNGraphWalktrap_html_a57ccd00f50fa4129424d384f6650f176"><div class="ttname"><a href="classscran_1_1ClusterSNNGraphWalktrap.html#a57ccd00f50fa4129424d384f6650f176">scran::ClusterSNNGraphWalktrap::run</a></div><div class="ttdeci">Results run(const Graph &amp;graph_info)</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:503</div></div>
<div class="ttc" id="aclassscran_1_1ClusterSNNGraphWalktrap_html_a726f2e2d6e3ad4d7bde13413260bedad"><div class="ttname"><a href="classscran_1_1ClusterSNNGraphWalktrap.html#a726f2e2d6e3ad4d7bde13413260bedad">scran::ClusterSNNGraphWalktrap::set_resolution</a></div><div class="ttdeci">ClusterSNNGraphWalktrap &amp; set_resolution(int s=Defaults::steps)</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:412</div></div>
<div class="ttc" id="aclassscran_1_1ClusterSNNGraphWalktrap_html_ac8f7d587efdafe46c79502bc7add1f16"><div class="ttname"><a href="classscran_1_1ClusterSNNGraphWalktrap.html#ac8f7d587efdafe46c79502bc7add1f16">scran::ClusterSNNGraphWalktrap::set_neighbors</a></div><div class="ttdeci">ClusterSNNGraphWalktrap &amp; set_neighbors(int k=BuildSNNGraph::Defaults::neighbors)</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:372</div></div>
<div class="ttc" id="aclassscran_1_1ClusterSNNGraphWalktrap_html_aeb77a7925c9064bd0f7db5b3f03d3dab"><div class="ttname"><a href="classscran_1_1ClusterSNNGraphWalktrap.html#aeb77a7925c9064bd0f7db5b3f03d3dab">scran::ClusterSNNGraphWalktrap::set_approximate</a></div><div class="ttdeci">ClusterSNNGraphWalktrap &amp; set_approximate(bool a=BuildSNNGraph::Defaults::approximate)</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:382</div></div>
<div class="ttc" id="aclassscran_1_1ClusterSNNGraphWalktrap_html_afb44998eb606e936bc5cfe289f269961"><div class="ttname"><a href="classscran_1_1ClusterSNNGraphWalktrap.html#afb44998eb606e936bc5cfe289f269961">scran::ClusterSNNGraphWalktrap::set_seed</a></div><div class="ttdeci">ClusterSNNGraphWalktrap &amp; set_seed(int s=Defaults::seed)</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:402</div></div>
<div class="ttc" id="aclassscran_1_1ClusterSNNGraph_html"><div class="ttname"><a href="classscran_1_1ClusterSNNGraph.html">scran::ClusterSNNGraph</a></div><div class="ttdoc">Virtual class for clustering on a shared nearest-neighbor graph.</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:27</div></div>
<div class="ttc" id="aclassscran_1_1ClusterSNNGraph_html_a613d3b3cd5c6ab31848f8c0e2084ca89"><div class="ttname"><a href="classscran_1_1ClusterSNNGraph.html#a613d3b3cd5c6ab31848f8c0e2084ca89">scran::ClusterSNNGraph::build</a></div><div class="ttdeci">Graph build(size_t ndims, size_t ncells, const double *mat) const</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:68</div></div>
<div class="ttc" id="aclassscran_1_1ClusterSNNGraph_html_a86208b4b339d88e3a93ef9ead03ef2bb"><div class="ttname"><a href="classscran_1_1ClusterSNNGraph.html#a86208b4b339d88e3a93ef9ead03ef2bb">scran::ClusterSNNGraph::build</a></div><div class="ttdeci">Graph build(size_t ncells, const std::deque&lt; BuildSNNGraph::WeightedEdge &gt; &amp;store) const</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:96</div></div>
<div class="ttc" id="aclassscran_1_1ClusterSNNGraph_html_aa777f85140bac6998e060838adf6c6bf"><div class="ttname"><a href="classscran_1_1ClusterSNNGraph.html#aa777f85140bac6998e060838adf6c6bf">scran::ClusterSNNGraph::build</a></div><div class="ttdeci">Graph build(const Algorithm *search) const</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:83</div></div>
<div class="ttc" id="astructscran_1_1BuildSNNGraph_1_1Defaults_html_a258288cda0e643719d53a834424b56a6"><div class="ttname"><a href="structscran_1_1BuildSNNGraph_1_1Defaults.html#a258288cda0e643719d53a834424b56a6">scran::BuildSNNGraph::Defaults::weighting_scheme</a></div><div class="ttdeci">static constexpr Scheme weighting_scheme</div><div class="ttdef"><b>Definition:</b> BuildSNNGraph.hpp:68</div></div>
<div class="ttc" id="astructscran_1_1BuildSNNGraph_1_1Defaults_html_a6a376b256377055e23a96c3d9eb96365"><div class="ttname"><a href="structscran_1_1BuildSNNGraph_1_1Defaults.html#a6a376b256377055e23a96c3d9eb96365">scran::BuildSNNGraph::Defaults::neighbors</a></div><div class="ttdeci">static constexpr int neighbors</div><div class="ttdef"><b>Definition:</b> BuildSNNGraph.hpp:63</div></div>
<div class="ttc" id="astructscran_1_1BuildSNNGraph_1_1Defaults_html_af6d0a1c84cd739442a6767171e0202e0"><div class="ttname"><a href="structscran_1_1BuildSNNGraph_1_1Defaults.html#af6d0a1c84cd739442a6767171e0202e0">scran::BuildSNNGraph::Defaults::approximate</a></div><div class="ttdeci">static constexpr bool approximate</div><div class="ttdef"><b>Definition:</b> BuildSNNGraph.hpp:73</div></div>
<div class="ttc" id="astructscran_1_1ClusterSNNGraphLeiden_1_1Defaults_html"><div class="ttname"><a href="structscran_1_1ClusterSNNGraphLeiden_1_1Defaults.html">scran::ClusterSNNGraphLeiden::Defaults</a></div><div class="ttdoc">Default parameter settings.</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:561</div></div>
<div class="ttc" id="astructscran_1_1ClusterSNNGraphLeiden_1_1Defaults_html_a235d41d736b35e40d0162d3eff856361"><div class="ttname"><a href="structscran_1_1ClusterSNNGraphLeiden_1_1Defaults.html#a235d41d736b35e40d0162d3eff856361">scran::ClusterSNNGraphLeiden::Defaults::resolution</a></div><div class="ttdeci">static constexpr double resolution</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:566</div></div>
<div class="ttc" id="astructscran_1_1ClusterSNNGraphLeiden_1_1Defaults_html_a90a2dca1eed5d37c6b12da18e9f0d9e8"><div class="ttname"><a href="structscran_1_1ClusterSNNGraphLeiden_1_1Defaults.html#a90a2dca1eed5d37c6b12da18e9f0d9e8">scran::ClusterSNNGraphLeiden::Defaults::beta</a></div><div class="ttdeci">static constexpr double beta</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:572</div></div>
<div class="ttc" id="astructscran_1_1ClusterSNNGraphLeiden_1_1Defaults_html_a9f83e589fd30c36c30c5ee5a4e9ccf8e"><div class="ttname"><a href="structscran_1_1ClusterSNNGraphLeiden_1_1Defaults.html#a9f83e589fd30c36c30c5ee5a4e9ccf8e">scran::ClusterSNNGraphLeiden::Defaults::seed</a></div><div class="ttdeci">static constexpr int seed</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:588</div></div>
<div class="ttc" id="astructscran_1_1ClusterSNNGraphLeiden_1_1Defaults_html_ac1bf98a6de928de8b786643942768deb"><div class="ttname"><a href="structscran_1_1ClusterSNNGraphLeiden_1_1Defaults.html#ac1bf98a6de928de8b786643942768deb">scran::ClusterSNNGraphLeiden::Defaults::modularity</a></div><div class="ttdeci">static constexpr bool modularity</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:583</div></div>
<div class="ttc" id="astructscran_1_1ClusterSNNGraphLeiden_1_1Defaults_html_adec09fa56454245d43af1561d1d4a8ea"><div class="ttname"><a href="structscran_1_1ClusterSNNGraphLeiden_1_1Defaults.html#adec09fa56454245d43af1561d1d4a8ea">scran::ClusterSNNGraphLeiden::Defaults::iterations</a></div><div class="ttdeci">static constexpr int iterations</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:578</div></div>
<div class="ttc" id="astructscran_1_1ClusterSNNGraphLeiden_1_1Results_html"><div class="ttname"><a href="structscran_1_1ClusterSNNGraphLeiden_1_1Results.html">scran::ClusterSNNGraphLeiden::Results</a></div><div class="ttdoc">Result of the igraph leiden community detection algorithm.</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:688</div></div>
<div class="ttc" id="astructscran_1_1ClusterSNNGraphLeiden_1_1Results_html_a2a59465810969c36e6a084f5cac31675"><div class="ttname"><a href="structscran_1_1ClusterSNNGraphLeiden_1_1Results.html#a2a59465810969c36e6a084f5cac31675">scran::ClusterSNNGraphLeiden::Results::membership</a></div><div class="ttdeci">std::vector&lt; int &gt; membership</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:698</div></div>
<div class="ttc" id="astructscran_1_1ClusterSNNGraphLeiden_1_1Results_html_a790d4642f2b5001595c569dcf0bf7ec6"><div class="ttname"><a href="structscran_1_1ClusterSNNGraphLeiden_1_1Results.html#a790d4642f2b5001595c569dcf0bf7ec6">scran::ClusterSNNGraphLeiden::Results::status</a></div><div class="ttdeci">int status</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:693</div></div>
<div class="ttc" id="astructscran_1_1ClusterSNNGraphLeiden_1_1Results_html_a997a0d553c10721ea74ffcafc5dfb742"><div class="ttname"><a href="structscran_1_1ClusterSNNGraphLeiden_1_1Results.html#a997a0d553c10721ea74ffcafc5dfb742">scran::ClusterSNNGraphLeiden::Results::quality</a></div><div class="ttdeci">double quality</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:703</div></div>
<div class="ttc" id="astructscran_1_1ClusterSNNGraphMultiLevel_1_1Defaults_html"><div class="ttname"><a href="structscran_1_1ClusterSNNGraphMultiLevel_1_1Defaults.html">scran::ClusterSNNGraphMultiLevel::Defaults</a></div><div class="ttdoc">Default parameter settings.</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:133</div></div>
<div class="ttc" id="astructscran_1_1ClusterSNNGraphMultiLevel_1_1Defaults_html_ac9eb6ed103b706b87b81050ac6ad4cc1"><div class="ttname"><a href="structscran_1_1ClusterSNNGraphMultiLevel_1_1Defaults.html#ac9eb6ed103b706b87b81050ac6ad4cc1">scran::ClusterSNNGraphMultiLevel::Defaults::resolution</a></div><div class="ttdeci">static constexpr double resolution</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:137</div></div>
<div class="ttc" id="astructscran_1_1ClusterSNNGraphMultiLevel_1_1Defaults_html_ad3584684d404d382240a908bd88df606"><div class="ttname"><a href="structscran_1_1ClusterSNNGraphMultiLevel_1_1Defaults.html#ad3584684d404d382240a908bd88df606">scran::ClusterSNNGraphMultiLevel::Defaults::seed</a></div><div class="ttdeci">static constexpr int seed</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:142</div></div>
<div class="ttc" id="astructscran_1_1ClusterSNNGraphMultiLevel_1_1Results_html"><div class="ttname"><a href="structscran_1_1ClusterSNNGraphMultiLevel_1_1Results.html">scran::ClusterSNNGraphMultiLevel::Results</a></div><div class="ttdoc">Result of the igraph multi-level community detection algorithm.</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:208</div></div>
<div class="ttc" id="astructscran_1_1ClusterSNNGraphMultiLevel_1_1Results_html_a27434f77a03c488270b68c08e5105e80"><div class="ttname"><a href="structscran_1_1ClusterSNNGraphMultiLevel_1_1Results.html#a27434f77a03c488270b68c08e5105e80">scran::ClusterSNNGraphMultiLevel::Results::membership</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; int &gt; &gt; membership</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:225</div></div>
<div class="ttc" id="astructscran_1_1ClusterSNNGraphMultiLevel_1_1Results_html_a569e235d05befc66022b27cf329c1b2d"><div class="ttname"><a href="structscran_1_1ClusterSNNGraphMultiLevel_1_1Results.html#a569e235d05befc66022b27cf329c1b2d">scran::ClusterSNNGraphMultiLevel::Results::max</a></div><div class="ttdeci">size_t max</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:219</div></div>
<div class="ttc" id="astructscran_1_1ClusterSNNGraphMultiLevel_1_1Results_html_ad24f154bae449495590393bdb2ff59fc"><div class="ttname"><a href="structscran_1_1ClusterSNNGraphMultiLevel_1_1Results.html#ad24f154bae449495590393bdb2ff59fc">scran::ClusterSNNGraphMultiLevel::Results::modularity</a></div><div class="ttdeci">std::vector&lt; double &gt; modularity</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:231</div></div>
<div class="ttc" id="astructscran_1_1ClusterSNNGraphMultiLevel_1_1Results_html_ad955a05f5d065e7de84d6c14a8da0564"><div class="ttname"><a href="structscran_1_1ClusterSNNGraphMultiLevel_1_1Results.html#ad955a05f5d065e7de84d6c14a8da0564">scran::ClusterSNNGraphMultiLevel::Results::status</a></div><div class="ttdeci">int status</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:213</div></div>
<div class="ttc" id="astructscran_1_1ClusterSNNGraphWalktrap_1_1Defaults_html"><div class="ttname"><a href="structscran_1_1ClusterSNNGraphWalktrap_1_1Defaults.html">scran::ClusterSNNGraphWalktrap::Defaults</a></div><div class="ttdoc">Default parameter settings.</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:349</div></div>
<div class="ttc" id="astructscran_1_1ClusterSNNGraphWalktrap_1_1Defaults_html_a87c5c1dab09f0a36f14900fd5ad5ddf9"><div class="ttname"><a href="structscran_1_1ClusterSNNGraphWalktrap_1_1Defaults.html#a87c5c1dab09f0a36f14900fd5ad5ddf9">scran::ClusterSNNGraphWalktrap::Defaults::seed</a></div><div class="ttdeci">static constexpr int seed</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:359</div></div>
<div class="ttc" id="astructscran_1_1ClusterSNNGraphWalktrap_1_1Defaults_html_aefa5e58e12dcef4517fec00389e99a7a"><div class="ttname"><a href="structscran_1_1ClusterSNNGraphWalktrap_1_1Defaults.html#aefa5e58e12dcef4517fec00389e99a7a">scran::ClusterSNNGraphWalktrap::Defaults::steps</a></div><div class="ttdeci">static constexpr int steps</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:354</div></div>
<div class="ttc" id="astructscran_1_1ClusterSNNGraphWalktrap_1_1Results_html"><div class="ttname"><a href="structscran_1_1ClusterSNNGraphWalktrap_1_1Results.html">scran::ClusterSNNGraphWalktrap::Results</a></div><div class="ttdoc">Result of the igraph Walktrap community detection algorithm.</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:421</div></div>
<div class="ttc" id="astructscran_1_1ClusterSNNGraphWalktrap_1_1Results_html_a54659717e5be3972357d5fd4680894d9"><div class="ttname"><a href="structscran_1_1ClusterSNNGraphWalktrap_1_1Results.html#a54659717e5be3972357d5fd4680894d9">scran::ClusterSNNGraphWalktrap::Results::modularity</a></div><div class="ttdeci">std::vector&lt; double &gt; modularity</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:443</div></div>
<div class="ttc" id="astructscran_1_1ClusterSNNGraphWalktrap_1_1Results_html_aa14b1d5ff2045c1513039697e5320d0f"><div class="ttname"><a href="structscran_1_1ClusterSNNGraphWalktrap_1_1Results.html#aa14b1d5ff2045c1513039697e5320d0f">scran::ClusterSNNGraphWalktrap::Results::membership</a></div><div class="ttdeci">std::vector&lt; int &gt; membership</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:431</div></div>
<div class="ttc" id="astructscran_1_1ClusterSNNGraphWalktrap_1_1Results_html_aa6ef7c62f9f348d3e26592956c467e50"><div class="ttname"><a href="structscran_1_1ClusterSNNGraphWalktrap_1_1Results.html#aa6ef7c62f9f348d3e26592956c467e50">scran::ClusterSNNGraphWalktrap::Results::merges</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; int, int &gt; &gt; merges</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:437</div></div>
<div class="ttc" id="astructscran_1_1ClusterSNNGraphWalktrap_1_1Results_html_acbde64cf906a6bacbf705e1c1bb7ffc4"><div class="ttname"><a href="structscran_1_1ClusterSNNGraphWalktrap_1_1Results.html#acbde64cf906a6bacbf705e1c1bb7ffc4">scran::ClusterSNNGraphWalktrap::Results::status</a></div><div class="ttdeci">int status</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:426</div></div>
<div class="ttc" id="astructscran_1_1ClusterSNNGraph_1_1Graph_html"><div class="ttname"><a href="structscran_1_1ClusterSNNGraph_1_1Graph.html">scran::ClusterSNNGraph::Graph</a></div><div class="ttdoc">Wrapper around the igraph_t class from igraph.</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:37</div></div>
<div class="ttc" id="astructscran_1_1ClusterSNNGraph_1_1Graph_html_a0d7cf0747ed7bff0c4e810dcbd77ebdb"><div class="ttname"><a href="structscran_1_1ClusterSNNGraph_1_1Graph.html#a0d7cf0747ed7bff0c4e810dcbd77ebdb">scran::ClusterSNNGraph::Graph::destroy</a></div><div class="ttdeci">void destroy()</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:51</div></div>
<div class="ttc" id="astructscran_1_1ClusterSNNGraph_1_1Graph_html_a1c0c132d946cf3883956168bea6f30f2"><div class="ttname"><a href="structscran_1_1ClusterSNNGraph_1_1Graph.html#a1c0c132d946cf3883956168bea6f30f2">scran::ClusterSNNGraph::Graph::weights</a></div><div class="ttdeci">igraph_vector_t weights</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:46</div></div>
<div class="ttc" id="astructscran_1_1ClusterSNNGraph_1_1Graph_html_a705ba30639aae97157d20e468294efe2"><div class="ttname"><a href="structscran_1_1ClusterSNNGraph_1_1Graph.html#a705ba30639aae97157d20e468294efe2">scran::ClusterSNNGraph::Graph::graph</a></div><div class="ttdeci">igraph_t graph</div><div class="ttdef"><b>Definition:</b> ClusterSNNGraph.hpp:41</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2
</small></address>
</body>
</html>
