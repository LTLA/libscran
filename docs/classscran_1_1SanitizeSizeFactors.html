<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>scran: scran::SanitizeSizeFactors Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">scran
   </div>
   <div id="projectbrief">C++ library for basic single-cell RNA-seq analyses</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescran.html">scran</a></li><li class="navelem"><a class="el" href="classscran_1_1SanitizeSizeFactors.html">SanitizeSizeFactors</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classscran_1_1SanitizeSizeFactors-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">scran::SanitizeSizeFactors Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Sanitize invalid size factors.  
 <a href="classscran_1_1SanitizeSizeFactors.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="SanitizeSizeFactors_8hpp_source.html">SanitizeSizeFactors.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran_1_1SanitizeSizeFactors_1_1Defaults.html">Defaults</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default parameters.  <a href="structscran_1_1SanitizeSizeFactors_1_1Defaults.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-types" name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a6503d23b9b2f1f37e080857d4c214148" id="r_a6503d23b9b2f1f37e080857d4c214148"><td class="memItemLeft" align="right" valign="top">enum class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran_1_1SanitizeSizeFactors.html#a6503d23b9b2f1f37e080857d4c214148">HandlerAction</a> : char { <b>IGNORE</b>
, <b>ERROR</b>
, <b>SANITIZE</b>
 }</td></tr>
<tr class="separator:a6503d23b9b2f1f37e080857d4c214148"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:af0059814c7b8a3a652afb8a04fd34e24" id="r_af0059814c7b8a3a652afb8a04fd34e24"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classscran_1_1SanitizeSizeFactors.html">SanitizeSizeFactors</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran_1_1SanitizeSizeFactors.html#af0059814c7b8a3a652afb8a04fd34e24">set_handle_zero</a> (<a class="el" href="classscran_1_1SanitizeSizeFactors.html#a6503d23b9b2f1f37e080857d4c214148">HandlerAction</a> h=<a class="el" href="structscran_1_1SanitizeSizeFactors_1_1Defaults.html#a2b9bb739592064d52e6bac4a65bc6ea5">Defaults::handle_zero</a>)</td></tr>
<tr class="separator:af0059814c7b8a3a652afb8a04fd34e24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb7add8be5e73861d560dc36549ed3a2" id="r_abb7add8be5e73861d560dc36549ed3a2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classscran_1_1SanitizeSizeFactors.html">SanitizeSizeFactors</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran_1_1SanitizeSizeFactors.html#abb7add8be5e73861d560dc36549ed3a2">set_handle_negative</a> (<a class="el" href="classscran_1_1SanitizeSizeFactors.html#a6503d23b9b2f1f37e080857d4c214148">HandlerAction</a> h=<a class="el" href="structscran_1_1SanitizeSizeFactors_1_1Defaults.html#aba981e3669e872b131921493f686bcfa">Defaults::handle_negative</a>)</td></tr>
<tr class="separator:abb7add8be5e73861d560dc36549ed3a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01c2aeb2f171ae337227b40e5f4b16d6" id="r_a01c2aeb2f171ae337227b40e5f4b16d6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classscran_1_1SanitizeSizeFactors.html">SanitizeSizeFactors</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran_1_1SanitizeSizeFactors.html#a01c2aeb2f171ae337227b40e5f4b16d6">set_handle_nan</a> (<a class="el" href="classscran_1_1SanitizeSizeFactors.html#a6503d23b9b2f1f37e080857d4c214148">HandlerAction</a> h=<a class="el" href="structscran_1_1SanitizeSizeFactors_1_1Defaults.html#afdb59be55d824afab4698de89b7bfadf">Defaults::handle_nan</a>)</td></tr>
<tr class="separator:a01c2aeb2f171ae337227b40e5f4b16d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8f74213be1b55628ee41999694b599d" id="r_ab8f74213be1b55628ee41999694b599d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classscran_1_1SanitizeSizeFactors.html">SanitizeSizeFactors</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran_1_1SanitizeSizeFactors.html#ab8f74213be1b55628ee41999694b599d">set_handle_infinite</a> (<a class="el" href="classscran_1_1SanitizeSizeFactors.html#a6503d23b9b2f1f37e080857d4c214148">HandlerAction</a> h=<a class="el" href="structscran_1_1SanitizeSizeFactors_1_1Defaults.html#a672ab9735710dafd54bd359bfbc84373">Defaults::handle_infinite</a>)</td></tr>
<tr class="separator:ab8f74213be1b55628ee41999694b599d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdc7acdb3bc06c19286b7d4f83d4053e" id="r_acdc7acdb3bc06c19286b7d4f83d4053e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classscran_1_1SanitizeSizeFactors.html">SanitizeSizeFactors</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran_1_1SanitizeSizeFactors.html#acdc7acdb3bc06c19286b7d4f83d4053e">set_handle_non_positive</a> (<a class="el" href="classscran_1_1SanitizeSizeFactors.html#a6503d23b9b2f1f37e080857d4c214148">HandlerAction</a> h)</td></tr>
<tr class="separator:acdc7acdb3bc06c19286b7d4f83d4053e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac74f5998ee7f28a55545e06badd64f18" id="r_ac74f5998ee7f28a55545e06badd64f18"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classscran_1_1SanitizeSizeFactors.html">SanitizeSizeFactors</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscran_1_1SanitizeSizeFactors.html#ac74f5998ee7f28a55545e06badd64f18">set_handle_non_finite</a> (<a class="el" href="classscran_1_1SanitizeSizeFactors.html#a6503d23b9b2f1f37e080857d4c214148">HandlerAction</a> h)</td></tr>
<tr class="separator:ac74f5998ee7f28a55545e06badd64f18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31ab4dd34f667b04e814dd77c33f82d4" id="r_a31ab4dd34f667b04e814dd77c33f82d4"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:a31ab4dd34f667b04e814dd77c33f82d4"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classscran_1_1SanitizeSizeFactors.html#a31ab4dd34f667b04e814dd77c33f82d4">run</a> (size_t n, T *size_factors, const <a class="el" href="structscran_1_1SizeFactorValidity.html">SizeFactorValidity</a> &amp;status) const</td></tr>
<tr class="separator:a31ab4dd34f667b04e814dd77c33f82d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadbcf2be0b67110295ebc5aaa1fa1f81" id="r_aadbcf2be0b67110295ebc5aaa1fa1f81"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:aadbcf2be0b67110295ebc5aaa1fa1f81"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classscran_1_1SanitizeSizeFactors.html#aadbcf2be0b67110295ebc5aaa1fa1f81">run</a> (size_t n, T *size_factors) const</td></tr>
<tr class="separator:aadbcf2be0b67110295ebc5aaa1fa1f81"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Sanitize invalid size factors. </p>
<p>Replace zero, missing or infinite values in the size factor array so that it can be used to compute well-defined normalized values. Such size factors can occasionally arise if, e.g., insufficient quality control was performed upstream. Check out the documentation in <code><a class="el" href="classscran_1_1SanitizeSizeFactors.html#af0059814c7b8a3a652afb8a04fd34e24">set_handle_zero()</a></code>, <code><a class="el" href="classscran_1_1SanitizeSizeFactors.html#abb7add8be5e73861d560dc36549ed3a2">set_handle_negative()</a></code>, and <code><a class="el" href="classscran_1_1SanitizeSizeFactors.html#a01c2aeb2f171ae337227b40e5f4b16d6">set_handle_nan()</a></code> and <code><a class="el" href="classscran_1_1SanitizeSizeFactors.html#ab8f74213be1b55628ee41999694b599d">set_handle_infinite()</a></code> for more details.</p>
<p>missing size factors with unity, and infinite size factors with the largest finite size factor. </p>
</div><h2 class="groupheader">Member Enumeration Documentation</h2>
<a id="a6503d23b9b2f1f37e080857d4c214148" name="a6503d23b9b2f1f37e080857d4c214148"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6503d23b9b2f1f37e080857d4c214148">&#9670;&#160;</a></span>HandlerAction</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum class <a class="el" href="classscran_1_1SanitizeSizeFactors.html#a6503d23b9b2f1f37e080857d4c214148">scran::SanitizeSizeFactors::HandlerAction</a> : char</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">strong</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>How invalid size factors should be handled:</p>
<ul>
<li><code>IGNORE</code>: ignore invalid size factors with no error or change.</li>
<li><code>ERROR</code>: throw an error.</li>
<li><code>SANITIZE</code>: fix each invalid size factor. </li>
</ul>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="af0059814c7b8a3a652afb8a04fd34e24" name="af0059814c7b8a3a652afb8a04fd34e24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0059814c7b8a3a652afb8a04fd34e24">&#9670;&#160;</a></span>set_handle_zero()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran_1_1SanitizeSizeFactors.html">SanitizeSizeFactors</a> &amp; scran::SanitizeSizeFactors::set_handle_zero </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran_1_1SanitizeSizeFactors.html#a6503d23b9b2f1f37e080857d4c214148">HandlerAction</a>&#160;</td>
          <td class="paramname"><em>h</em> = <code><a class="el" href="structscran_1_1SanitizeSizeFactors_1_1Defaults.html#a2b9bb739592064d52e6bac4a65bc6ea5">Defaults::handle_zero</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>How should we handle zero size factors? If <code>SANITIZE</code>, they will be automatically set to the smallest valid size factor (or 1, if all size factors are invalid).</p>
<p>This approach is motivated by the observation that size factors of zero are typically generated from all-zero cells. By replacing the size factor with a finite value, we ensure that any all-zero cells are represented by all-zero columns in the normalized matrix, which is a reasonable outcome if those cells cannot be filtered out during upstream quality control.</p>
<p>We also need to handle cases where a zero size factor may be generated from a cell with non-zero rows, e.g., with <code><a class="el" href="classscran_1_1MedianSizeFactors.html" title="Compute median-based size factors to handle composition bias.">MedianSizeFactors</a></code>. By using a "relatively small" replacement value, we ensure that the normalized values reflect the extremity of the scaling.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">h</td><td>How to handle a size factor of zero.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A reference to this <code><a class="el" href="classscran_1_1SanitizeSizeFactors.html" title="Sanitize invalid size factors.">SanitizeSizeFactors</a></code> object. </dd></dl>

</div>
</div>
<a id="abb7add8be5e73861d560dc36549ed3a2" name="abb7add8be5e73861d560dc36549ed3a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb7add8be5e73861d560dc36549ed3a2">&#9670;&#160;</a></span>set_handle_negative()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran_1_1SanitizeSizeFactors.html">SanitizeSizeFactors</a> &amp; scran::SanitizeSizeFactors::set_handle_negative </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran_1_1SanitizeSizeFactors.html#a6503d23b9b2f1f37e080857d4c214148">HandlerAction</a>&#160;</td>
          <td class="paramname"><em>h</em> = <code><a class="el" href="structscran_1_1SanitizeSizeFactors_1_1Defaults.html#aba981e3669e872b131921493f686bcfa">Defaults::handle_negative</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>How should we handle negative size factors? If <code>SANITIZE</code>, they will be automatically set to the smallest valid size factor (or 1, if all size factors are invalid). This approach follows the same logic as <code><a class="el" href="classscran_1_1SanitizeSizeFactors.html#af0059814c7b8a3a652afb8a04fd34e24">set_handle_zero()</a></code>, though negative size factors are quite unusual.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">h</td><td>How to handle a negative size factor.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A reference to this <code><a class="el" href="classscran_1_1SanitizeSizeFactors.html" title="Sanitize invalid size factors.">SanitizeSizeFactors</a></code> object. </dd></dl>

</div>
</div>
<a id="a01c2aeb2f171ae337227b40e5f4b16d6" name="a01c2aeb2f171ae337227b40e5f4b16d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01c2aeb2f171ae337227b40e5f4b16d6">&#9670;&#160;</a></span>set_handle_nan()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran_1_1SanitizeSizeFactors.html">SanitizeSizeFactors</a> &amp; scran::SanitizeSizeFactors::set_handle_nan </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran_1_1SanitizeSizeFactors.html#a6503d23b9b2f1f37e080857d4c214148">HandlerAction</a>&#160;</td>
          <td class="paramname"><em>h</em> = <code><a class="el" href="structscran_1_1SanitizeSizeFactors_1_1Defaults.html#afdb59be55d824afab4698de89b7bfadf">Defaults::handle_nan</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>How should we handle NaN size factors? If `SANITIZE, NaN size factors will be automatically set to 1, meaning that scaling is a no-op.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">h</td><td>How to handle NaN size factors.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A reference to this <code><a class="el" href="classscran_1_1SanitizeSizeFactors.html" title="Sanitize invalid size factors.">SanitizeSizeFactors</a></code> object. </dd></dl>

</div>
</div>
<a id="ab8f74213be1b55628ee41999694b599d" name="ab8f74213be1b55628ee41999694b599d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8f74213be1b55628ee41999694b599d">&#9670;&#160;</a></span>set_handle_infinite()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran_1_1SanitizeSizeFactors.html">SanitizeSizeFactors</a> &amp; scran::SanitizeSizeFactors::set_handle_infinite </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran_1_1SanitizeSizeFactors.html#a6503d23b9b2f1f37e080857d4c214148">HandlerAction</a>&#160;</td>
          <td class="paramname"><em>h</em> = <code><a class="el" href="structscran_1_1SanitizeSizeFactors_1_1Defaults.html#a672ab9735710dafd54bd359bfbc84373">Defaults::handle_infinite</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>How shuld be handle infinite size factors. If <code>SANITIZE</code>, infinite size factors will be automatically set to the largest valid size factor (or 1, if all size factors are invalid). This ensures that any normalized values will be, at least, finite; the choice of a relatively large replacement value reflects the extremity of the scaling.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">h</td><td>How to handle infinite size factors.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A reference to this <code><a class="el" href="classscran_1_1SanitizeSizeFactors.html" title="Sanitize invalid size factors.">SanitizeSizeFactors</a></code> object. </dd></dl>

</div>
</div>
<a id="acdc7acdb3bc06c19286b7d4f83d4053e" name="acdc7acdb3bc06c19286b7d4f83d4053e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acdc7acdb3bc06c19286b7d4f83d4053e">&#9670;&#160;</a></span>set_handle_non_positive()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran_1_1SanitizeSizeFactors.html">SanitizeSizeFactors</a> &amp; scran::SanitizeSizeFactors::set_handle_non_positive </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran_1_1SanitizeSizeFactors.html#a6503d23b9b2f1f37e080857d4c214148">HandlerAction</a>&#160;</td>
          <td class="paramname"><em>h</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Wrapper to both <code><a class="el" href="classscran_1_1SanitizeSizeFactors.html#af0059814c7b8a3a652afb8a04fd34e24">set_handle_zero()</a></code> and <code><a class="el" href="classscran_1_1SanitizeSizeFactors.html#abb7add8be5e73861d560dc36549ed3a2">set_handle_negative()</a></code> in one call.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">h</td><td>How to handle non-positive size factors.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A reference to this <code><a class="el" href="classscran_1_1SanitizeSizeFactors.html" title="Sanitize invalid size factors.">SanitizeSizeFactors</a></code> object. </dd></dl>

</div>
</div>
<a id="ac74f5998ee7f28a55545e06badd64f18" name="ac74f5998ee7f28a55545e06badd64f18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac74f5998ee7f28a55545e06badd64f18">&#9670;&#160;</a></span>set_handle_non_finite()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran_1_1SanitizeSizeFactors.html">SanitizeSizeFactors</a> &amp; scran::SanitizeSizeFactors::set_handle_non_finite </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classscran_1_1SanitizeSizeFactors.html#a6503d23b9b2f1f37e080857d4c214148">HandlerAction</a>&#160;</td>
          <td class="paramname"><em>h</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Wrapper to both <code>set_handle_infinte()</code> and <code><a class="el" href="classscran_1_1SanitizeSizeFactors.html#a01c2aeb2f171ae337227b40e5f4b16d6">set_handle_nan()</a></code> in one call.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">h</td><td>How to handle non-finite size factors.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A reference to this <code><a class="el" href="classscran_1_1SanitizeSizeFactors.html" title="Sanitize invalid size factors.">SanitizeSizeFactors</a></code> object. </dd></dl>

</div>
</div>
<a id="a31ab4dd34f667b04e814dd77c33f82d4" name="a31ab4dd34f667b04e814dd77c33f82d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31ab4dd34f667b04e814dd77c33f82d4">&#9670;&#160;</a></span>run() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void scran::SanitizeSizeFactors::run </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>size_factors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structscran_1_1SizeFactorValidity.html">SizeFactorValidity</a> &amp;&#160;</td>
          <td class="paramname"><em>status</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T</td><td>Floating-point type for the size factors.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">n</td><td>Number of size factors. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">size_factors</td><td>Pointer to an array of positive size factors of length <code>n</code>. On output, invalid size factors are replaced. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">status</td><td>A pre-computed object indicating whether invalid size factors are present in <code>size_factors</code>. This can be useful if this information is already provided by, e.g., <code><a class="el" href="classscran_1_1CenterSizeFactors.html#a2a9139176f46d5e4e4f715ef268274e8">CenterSizeFactors::run()</a></code>. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aadbcf2be0b67110295ebc5aaa1fa1f81" name="aadbcf2be0b67110295ebc5aaa1fa1f81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aadbcf2be0b67110295ebc5aaa1fa1f81">&#9670;&#160;</a></span>run() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void scran::SanitizeSizeFactors::run </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">T *&#160;</td>
          <td class="paramname"><em>size_factors</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">T</td><td>Floating-point type for the size factors.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">n</td><td>Number of size factors. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">size_factors</td><td>Pointer to an array of positive size factors of length <code>n</code>. On output, invalid size factors are replaced. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>scran/normalization/<a class="el" href="SanitizeSizeFactors_8hpp_source.html">SanitizeSizeFactors.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
