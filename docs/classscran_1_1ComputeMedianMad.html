<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>scran: scran::ComputeMedianMad Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">scran
   </div>
   <div id="projectbrief">C++ library for basic single-cell RNA-seq analyses</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescran.html">scran</a></li><li class="navelem"><a class="el" href="classscran_1_1ComputeMedianMad.html">ComputeMedianMad</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="classscran_1_1ComputeMedianMad-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">scran::ComputeMedianMad Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Compute the median and MAD from an array of values.  
 <a href="#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="ComputeMedianMad_8hpp_source.html">ComputeMedianMad.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran_1_1ComputeMedianMad_1_1Defaults.html">Defaults</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default parameters.  <a href="structscran_1_1ComputeMedianMad_1_1Defaults.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscran_1_1ComputeMedianMad_1_1Results.html">Results</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Medians and MADs, possibly for multiple blocks.  <a href="structscran_1_1ComputeMedianMad_1_1Results.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:acd4ae0ce9a788e39d43b8f6bd4deacf5" id="r_acd4ae0ce9a788e39d43b8f6bd4deacf5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classscran_1_1ComputeMedianMad.html">ComputeMedianMad</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acd4ae0ce9a788e39d43b8f6bd4deacf5">set_log</a> (bool l=<a class="el" href="structscran_1_1ComputeMedianMad_1_1Defaults.html#a095a3632edf95f2271506ecdaed5c2d5">Defaults::log</a>)</td></tr>
<tr class="separator:acd4ae0ce9a788e39d43b8f6bd4deacf5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a045fe90e5a380bbda7c7edbb3bea94" id="r_a1a045fe90e5a380bbda7c7edbb3bea94"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classscran_1_1ComputeMedianMad.html">ComputeMedianMad</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1a045fe90e5a380bbda7c7edbb3bea94">set_median_only</a> (bool m=<a class="el" href="structscran_1_1ComputeMedianMad_1_1Defaults.html#ab9474c93b07481e5a85d4c94f50f9327">Defaults::median_only</a>)</td></tr>
<tr class="separator:a1a045fe90e5a380bbda7c7edbb3bea94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04e0171f1c90ce6eaecf90edb07434d5" id="r_a04e0171f1c90ce6eaecf90edb07434d5"><td class="memTemplParams" colspan="2">template&lt;typename Input , typename Buffer &gt; </td></tr>
<tr class="memitem:a04e0171f1c90ce6eaecf90edb07434d5"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="structscran_1_1ComputeMedianMad_1_1Results.html">Results</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a04e0171f1c90ce6eaecf90edb07434d5">run</a> (size_t n, const Input *metrics, Buffer *buffer) const</td></tr>
<tr class="separator:a04e0171f1c90ce6eaecf90edb07434d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90117d01128097973cea3de79c143f09" id="r_a90117d01128097973cea3de79c143f09"><td class="memTemplParams" colspan="2">template&lt;typename Input &gt; </td></tr>
<tr class="memitem:a90117d01128097973cea3de79c143f09"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="structscran_1_1ComputeMedianMad_1_1Results.html">Results</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a90117d01128097973cea3de79c143f09">run</a> (size_t n, const Input *metrics) const</td></tr>
<tr class="separator:a90117d01128097973cea3de79c143f09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d67389188de09d14a4c5cc45ab81aa8" id="r_a4d67389188de09d14a4c5cc45ab81aa8"><td class="memTemplParams" colspan="2">template&lt;typename Input , typename Block , typename Buffer &gt; </td></tr>
<tr class="memitem:a4d67389188de09d14a4c5cc45ab81aa8"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="structscran_1_1ComputeMedianMad_1_1Results.html">Results</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a4d67389188de09d14a4c5cc45ab81aa8">run_blocked</a> (size_t n, const Block *block, std::vector&lt; int &gt; starts, const Input *metrics, Buffer *buffer) const</td></tr>
<tr class="separator:a4d67389188de09d14a4c5cc45ab81aa8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a927b6baa8536237082c994c02f1c0789" id="r_a927b6baa8536237082c994c02f1c0789"><td class="memTemplParams" colspan="2">template&lt;typename Block , typename Input &gt; </td></tr>
<tr class="memitem:a927b6baa8536237082c994c02f1c0789"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="structscran_1_1ComputeMedianMad_1_1Results.html">Results</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#a927b6baa8536237082c994c02f1c0789">run_blocked</a> (size_t n, const Block *block, const Input *metrics) const</td></tr>
<tr class="separator:a927b6baa8536237082c994c02f1c0789"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:abd26968faaf644b43ace71197049cf08" id="r_abd26968faaf644b43ace71197049cf08"><td class="memTemplParams" colspan="2">template&lt;typename Block &gt; </td></tr>
<tr class="memitem:abd26968faaf644b43ace71197049cf08"><td class="memTemplItemLeft" align="right" valign="top">static std::vector&lt; int &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="#abd26968faaf644b43ace71197049cf08">compute_block_starts</a> (size_t n, const Block *block)</td></tr>
<tr class="separator:abd26968faaf644b43ace71197049cf08"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Compute the median and MAD from an array of values. </p>
<p>Pretty much as it says on the can; computes the median of an array of values first, and uses the median to then compute the median absolute deviation (MAD) from that array. We support calculation of medians and MADs for separate "blocks" of observations in the same array. These statistics can be used in <code>FilterOutliers</code> to obtain filter thresholds for removing outliers. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="acd4ae0ce9a788e39d43b8f6bd4deacf5" name="acd4ae0ce9a788e39d43b8f6bd4deacf5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd4ae0ce9a788e39d43b8f6bd4deacf5">&#9670;&#160;</a></span>set_log()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran_1_1ComputeMedianMad.html">ComputeMedianMad</a> &amp; scran::ComputeMedianMad::set_log </td>
          <td>(</td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>l</em></span><span class="paramdefsep"> = </span><span class="paramdefval"><a class="el" href="structscran_1_1ComputeMedianMad_1_1Defaults.html#a095a3632edf95f2271506ecdaed5c2d5">Defaults::log</a></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">l</td><td>Whether to compute the median and MAD after log-transformation of the values. This is useful for defining thresholds based on fold changes from the center. If <code>true</code>, all values are assumed to be non-negative.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A reference to this <code><a class="el" href="classscran_1_1ComputeMedianMad.html" title="Compute the median and MAD from an array of values.">ComputeMedianMad</a></code> object. </dd></dl>

</div>
</div>
<a id="a1a045fe90e5a380bbda7c7edbb3bea94" name="a1a045fe90e5a380bbda7c7edbb3bea94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a045fe90e5a380bbda7c7edbb3bea94">&#9670;&#160;</a></span>set_median_only()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classscran_1_1ComputeMedianMad.html">ComputeMedianMad</a> &amp; scran::ComputeMedianMad::set_median_only </td>
          <td>(</td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>m</em></span><span class="paramdefsep"> = </span><span class="paramdefval"><a class="el" href="structscran_1_1ComputeMedianMad_1_1Defaults.html#ab9474c93b07481e5a85d4c94f50f9327">Defaults::median_only</a></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">m</td><td>Whether to only compute the median. If true, <code><a class="el" href="structscran_1_1ComputeMedianMad_1_1Results.html#a88c52d12ebb26ba8e56dfb22d2923980">Results::mads</a></code> will be filled with NaNs.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A reference to this <code><a class="el" href="classscran_1_1ComputeMedianMad.html" title="Compute the median and MAD from an array of values.">ComputeMedianMad</a></code> object. </dd></dl>

</div>
</div>
<a id="abd26968faaf644b43ace71197049cf08" name="abd26968faaf644b43ace71197049cf08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd26968faaf644b43ace71197049cf08">&#9670;&#160;</a></span>compute_block_starts()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Block &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static std::vector&lt; int &gt; scran::ComputeMedianMad::compute_block_starts </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Block *</td>          <td class="paramname"><span class="paramname"><em>block</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Block</td><td>Integer type, containing the block IDs.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">n</td><td>Number of observations. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">block</td><td>Pointer to an array of block identifiers. If provided, the array should be of length equal to <code>n</code>. Values should be integer IDs in <picture><source srcset="form_0_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$[0, N)$" src="form_0.png"/></picture> where <picture><source srcset="form_1_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$N$" src="form_1.png"/></picture> is the number of blocks. If a null pointer is supplied, all observations are assumed to belong to the same block.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Vector of indices specifying the start position for each block on the workspace buffer, if observations from successive blocks were arranged contiguously onto the buffer. </dd></dl>

</div>
</div>
<a id="a04e0171f1c90ce6eaecf90edb07434d5" name="a04e0171f1c90ce6eaecf90edb07434d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04e0171f1c90ce6eaecf90edb07434d5">&#9670;&#160;</a></span>run() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Input , typename Buffer &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structscran_1_1ComputeMedianMad_1_1Results.html">Results</a> scran::ComputeMedianMad::run </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Input *</td>          <td class="paramname"><span class="paramname"><em>metrics</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Buffer *</td>          <td class="paramname"><span class="paramname"><em>buffer</em></span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Input</td><td>Numeric type for the input. </td></tr>
    <tr><td class="paramname">Buffer</td><td>Floating-point type for the buffer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">n</td><td>Number of observations. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">metrics</td><td>Pointer to an array of observations of length <code>n</code>. NaNs are ignored. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">buffer</td><td>Pointer to an array of length <code>n</code>, to be used as a workspace.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Median and MAD for the <code>metrics</code>. </dd></dl>

</div>
</div>
<a id="a90117d01128097973cea3de79c143f09" name="a90117d01128097973cea3de79c143f09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90117d01128097973cea3de79c143f09">&#9670;&#160;</a></span>run() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Input &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structscran_1_1ComputeMedianMad_1_1Results.html">Results</a> scran::ComputeMedianMad::run </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Input *</td>          <td class="paramname"><span class="paramname"><em>metrics</em></span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This is an overloaded member function, provided for convenience. It differs from the above function only in what argument(s) it accepts. </p><dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Input</td><td>Numeric type for the input.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">n</td><td>Number of observations. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">metrics</td><td>Pointer to an array of observations of length <code>n</code>. NaNs are ignored.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Median and the MAD for <code>metrics</code>. </dd></dl>

</div>
</div>
<a id="a4d67389188de09d14a4c5cc45ab81aa8" name="a4d67389188de09d14a4c5cc45ab81aa8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d67389188de09d14a4c5cc45ab81aa8">&#9670;&#160;</a></span>run_blocked() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Input , typename Block , typename Buffer &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structscran_1_1ComputeMedianMad_1_1Results.html">Results</a> scran::ComputeMedianMad::run_blocked </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Block *</td>          <td class="paramname"><span class="paramname"><em>block</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int &gt;</td>          <td class="paramname"><span class="paramname"><em>starts</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Input *</td>          <td class="paramname"><span class="paramname"><em>metrics</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Buffer *</td>          <td class="paramname"><span class="paramname"><em>buffer</em></span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Block</td><td>Integer type, containing the block IDs. </td></tr>
    <tr><td class="paramname">Input</td><td>Numeric type for the input. </td></tr>
    <tr><td class="paramname">Buffer</td><td>Floating-point type for the buffer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">n</td><td>Number of observations. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">block</td><td>Optional pointer to an array of block identifiers. If provided, the array should be of length equal to <code>ncells</code>. Values should be integer IDs in <picture><source srcset="form_0_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$[0, N)$" src="form_0.png"/></picture> where <picture><source srcset="form_1_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$N$" src="form_1.png"/></picture> is the number of blocks. If a null pointer is supplied, all observations are assumed to belong to the same block. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">starts</td><td>Vector of start positions for the observations from each block, typically generated by calling <code><a class="el" href="#abd26968faaf644b43ace71197049cf08">compute_block_starts()</a></code> on <code>n</code> and <code>block</code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">metrics</td><td>Pointer to an array of observations of length <code>n</code>. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">buffer</td><td>Pointer to an array of length <code>n</code>, to be used as a workspace.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Medians and MADs for each block in <code>metrics</code>. </dd></dl>

</div>
</div>
<a id="a927b6baa8536237082c994c02f1c0789" name="a927b6baa8536237082c994c02f1c0789"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a927b6baa8536237082c994c02f1c0789">&#9670;&#160;</a></span>run_blocked() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Block , typename Input &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structscran_1_1ComputeMedianMad_1_1Results.html">Results</a> scran::ComputeMedianMad::run_blocked </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>n</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Block *</td>          <td class="paramname"><span class="paramname"><em>block</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Input *</td>          <td class="paramname"><span class="paramname"><em>metrics</em></span>&#160;) const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This is an overloaded member function, provided for convenience. It differs from the above function only in what argument(s) it accepts. </p><dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Block</td><td>Integer type, containing the block IDs. </td></tr>
    <tr><td class="paramname">Input</td><td>Type of observation, numeric.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">n</td><td>Number of observations. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">block</td><td>Optional pointer to an array of block identifiers. If provided, the array should be of length equal to <code>ncells</code>. Values should be integer IDs in <picture><source srcset="form_0_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$[0, N)$" src="form_0.png"/></picture> where <picture><source srcset="form_1_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$N$" src="form_1.png"/></picture> is the number of blocks. If a null pointer is supplied, all observations are assumed to belong to the same block. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">metrics</td><td>Pointer to an array of observations of length <code>n</code>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Median and the MAD for each block in <code>metrics</code>. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>scran/quality_control/<a class="el" href="ComputeMedianMad_8hpp_source.html">ComputeMedianMad.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
